"use strict";(self.webpackChunkwebpack_demo=self.webpackChunkwebpack_demo||[]).push([[505],{505:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, {\n  "Z": () => (/* binding */ CalendarCreationDOMInteractions)\n});\n\n// EXTERNAL MODULE: ./src/Functions/Request/ajax.js\nvar ajax = __webpack_require__(54);\n// EXTERNAL MODULE: ./src/Functions/Tools/DOMTools.js\nvar DOMTools = __webpack_require__(804);\n// EXTERNAL MODULE: ./src/Functions/Tools/Tools.js\nvar Tools = __webpack_require__(337);\n;// CONCATENATED MODULE: ./src/RepetitionsGeneration/Repetition.js\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, "prototype", { writable: false }); return Constructor; }\n\nvar Repetition = /*#__PURE__*/function () {\n  function Repetition() {\n    _classCallCheck(this, Repetition);\n\n    /**\r\n     * @property hoursForNextRepetitions indexé par les rangs de répétitions\r\n     * @type {{number: [number, number],\r\n     * number: [number, number], number: [number, number],\r\n     * number: [number, number], number: [number, number]\r\n     * }}\r\n     */\n    this.hoursForNextRepetitions = {\n      1: [8, 0],\n      2: [24, 1],\n      3: [24 * 7, 7],\n      4: [27 * 7 * 2, 14],\n      5: [24 * 30, 30]\n    };\n    /**\r\n     * @type {{morning: [number, number], afternoon: [number, number]}}\r\n     */\n\n    this.hoursInADay = {\n      morning: [8, 11.30],\n      afternoon: [14, 20]\n    };\n  }\n  /**\r\n   * \r\n   * @param {number} newHourValue \r\n   * @return {boolean}\r\n   */\n\n\n  _createClass(Repetition, [{\n    key: "isBeforeWorkTime",\n    value: function isBeforeWorkTime(newHourValue) {\n      return newHourValue < this.hoursInADay.morning[0];\n    }\n    /**\r\n     * \r\n     * @param {number} newHourValue \r\n     * @return {boolean}\r\n     */\n\n  }, {\n    key: "isInWorkTime",\n    value: function isInWorkTime(newHourValue) {\n      var morningHours = this.repetition.hoursInADay.morning;\n      var afternoonHours = this.repetition.hoursInADay.afternoon;\n      return newHourValue > morningHours[0] && newHourValue < morningHours[1] || newHourValue > afternoonHours[0] && newHourValue < afternoonHours[1];\n    }\n  }]);\n\n  return Repetition;\n}();\n\n\n;// CONCATENATED MODULE: ./src/RepetitionsGeneration/RepetitionDate.js\nfunction _typeof(obj) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, _typeof(obj); }\n\nfunction RepetitionDate_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction RepetitionDate_createClass(Constructor, protoProps, staticProps) { if (protoProps) RepetitionDate_defineProperties(Constructor.prototype, protoProps); if (staticProps) RepetitionDate_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, "prototype", { writable: false }); return Constructor; }\n\nfunction RepetitionDate_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, "prototype", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } else if (call !== void 0) { throw new TypeError("Derived constructors may only return object or undefined"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called"); } return self; }\n\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === "function" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== "function") { throw new TypeError("Super expression must either be null or a function"); } if (typeof _cache !== "undefined") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\n\nfunction _construct(Parent, args, Class) { if (_isNativeReflectConstruct()) { _construct = Reflect.construct.bind(); } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf("[native code]") !== -1; }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar RepetitionDate = /*#__PURE__*/function (_Date) {\n  _inherits(RepetitionDate, _Date);\n\n  var _super = _createSuper(RepetitionDate);\n\n  function RepetitionDate(year) {\n    var _this;\n\n    RepetitionDate_classCallCheck(this, RepetitionDate);\n\n    _this = _super.call(this);\n    _this.numberOfDaysPerMonth = {\n      1: 31,\n      2: 28,\n      3: 31,\n      4: 30,\n      5: 31,\n      6: 30,\n      7: 31,\n      8: 31,\n      9: 30,\n      10: 31,\n      11: 30,\n      12: 31\n    };\n    return _this;\n  }\n\n  return RepetitionDate_createClass(RepetitionDate);\n}( /*#__PURE__*/_wrapNativeSuper(Date));\n\n\n;// CONCATENATED MODULE: ./src/responsives/modalResize.js\nfunction modalResize_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\nfunction modalResize_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction modalResize_createClass(Constructor, protoProps, staticProps) { if (protoProps) modalResize_defineProperties(Constructor.prototype, protoProps); if (staticProps) modalResize_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, "prototype", { writable: false }); return Constructor; }\n\nvar modalResize = /*#__PURE__*/function () {\n  function modalResize(CalendarCreationDOM) {\n    modalResize_classCallCheck(this, modalResize);\n\n    /**\r\n     * @type CalendarCreationDOMInteractions\r\n     */\n    this.calendarCreationDOM = CalendarCreationDOM;\n    this.isRowActionButtonsHidden = false;\n    this.handleWindowResize();\n    window.addEventListener(\'resize\', this.handleWindowResize.bind(this));\n  }\n\n  modalResize_createClass(modalResize, [{\n    key: "handleWindowResize",\n    value: function handleWindowResize() {\n      var hideRowActionButtons = window.innerWidth <= 800;\n\n      if (hideRowActionButtons && this.calendarCreationDOM.modal) {\n        this.isRowActionButtonsHidden = true;\n        this.calendarCreationDOM.appendRowActionButtonsIntoAMenu();\n      } else if (!hideRowActionButtons && this.calendarCreationDOM.modal && this.isRowActionButtonsHidden) {\n        this.calendarCreationDOM.getRowActionButtonsOutOfMenu();\n        this.isRowActionButtonsHidden = false;\n      }\n    }\n  }]);\n\n  return modalResize;\n}();\n// EXTERNAL MODULE: ./src/AbstractClasses/DOMInteractions.js\nvar DOMInteractions = __webpack_require__(941);\n;// CONCATENATED MODULE: ./src/AbstractClasses/Tools/calendarGenerationTools.js\nfunction calendarGenerationTools_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\nfunction calendarGenerationTools_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction calendarGenerationTools_createClass(Constructor, protoProps, staticProps) { if (protoProps) calendarGenerationTools_defineProperties(Constructor.prototype, protoProps); if (staticProps) calendarGenerationTools_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, "prototype", { writable: false }); return Constructor; }\n\n\n\nvar calendarGenerationTools = /*#__PURE__*/function () {\n  /**\r\n   * \r\n   * @param {calendarGeneration} calendarGeneration \r\n   */\n  function calendarGenerationTools() {\n    calendarGenerationTools_classCallCheck(this, calendarGenerationTools);\n\n    this.modal = document.querySelector(\'.calendar_creation_modal\');\n    this.dateTypeInputs = [];\n    this.inputsWithSameDate = {};\n    this.inputsWithPlusValueToAdd = [];\n    this.currentDateTypeInput;\n    this.linesToRepeat = {};\n    this.linesOfInputsWithSameDate = {};\n    /**\r\n     * @type {{[key: string]: HTMLTableRowElement[]} | undefined}\r\n     */\n\n    this.currentObjToLoopForSpacing;\n    this.nextDateTypeInput;\n    this.numberOfLinesOfExercise = 0;\n    this.numberOfLinesOfExercisePerDate = [];\n    this.spaceIsUnder2H = false;\n  }\n\n  calendarGenerationTools_createClass(calendarGenerationTools, [{\n    key: "fillInputsWithSameDate",\n    value: function fillInputsWithSameDate() {\n      this.inputs = (0,Tools/* createArray */.Ri)(this.modal.querySelectorAll(\'input\'));\n      this.fillDateTypeInputs();\n      this.fillInputsWithSameByDateTypeInputs();\n    }\n  }, {\n    key: "fillDateTypeInputs",\n    value: function fillDateTypeInputs() {\n      var _this = this;\n\n      (0,Tools/* foreachArrayElements */.$f)(this.inputs, function (input) {\n        if (input.id === \'date-input\') {\n          (0,Tools/* pushElementToArray */.n6)(input, _this.dateTypeInputs);\n        }\n      });\n    }\n  }, {\n    key: "fillInputsWithSameByDateTypeInputs",\n    value: function fillInputsWithSameByDateTypeInputs() {\n      var _this2 = this;\n\n      (0,Tools/* classicForLoop */.Sw)(this.dateTypeInputs, function (currentDateTypeInput, nextDateTypeInput) {\n        _this2.currentDateTypeInput = currentDateTypeInput;\n        _this2.nextDateTypeInput = nextDateTypeInput;\n\n        if (!(0,Tools/* isUndefined */.o8)(nextDateTypeInput)) {\n          _this2.handleDateInCurrentAndNextDateTypeInputsAreSame();\n\n          _this2.handleDateInCurrentAndNextDateTypeInputsAreDifferents();\n        } else {\n          _this2.pushCurrentDateTypeInput();\n        }\n      });\n    }\n  }, {\n    key: "handleDateInCurrentAndNextDateTypeInputsAreSame",\n    value: function handleDateInCurrentAndNextDateTypeInputsAreSame() {\n      var dateInCurrentInput = this.currentDateTypeInput.value;\n      var dateInNextInput = this.nextDateTypeInput.value;\n\n      if (dateInCurrentInput === dateInNextInput) {\n        this.pushCurrentAndNextDateTypeInputInSameArray(dateInCurrentInput);\n      }\n    }\n  }, {\n    key: "pushCurrentAndNextDateTypeInputInSameArray",\n    value: function pushCurrentAndNextDateTypeInputInSameArray(date) {\n      if ((0,Tools/* isUndefined */.o8)(this.inputsWithSameDate[date])) {\n        this.inputsWithSameDate[date] = [];\n        this.inputsWithSameDate[date].push(this.currentDateTypeInput);\n        this.inputsWithSameDate[date].push(this.nextDateTypeInput);\n      } else {\n        this.inputsWithSameDate[date].push(this.nextDateTypeInput);\n      }\n    }\n  }, {\n    key: "handleDateInCurrentAndNextDateTypeInputsAreDifferents",\n    value: function handleDateInCurrentAndNextDateTypeInputsAreDifferents() {\n      var dateInCurrentInput = this.currentDateTypeInput.value;\n      var dateInNextInput = this.nextDateTypeInput.value;\n\n      if (dateInCurrentInput !== dateInNextInput) {\n        this.pushCurrentAndNextDateTypeInputInDifferentArrays(dateInCurrentInput, dateInNextInput);\n      }\n    }\n  }, {\n    key: "pushCurrentAndNextDateTypeInputInDifferentArrays",\n    value: function pushCurrentAndNextDateTypeInputInDifferentArrays(dateInCurrentInput, dateInNextInput) {\n      if ((0,Tools/* isUndefined */.o8)(this.inputsWithSameDate[dateInCurrentInput])) {\n        this.inputsWithSameDate[dateInCurrentInput] = [];\n        this.inputsWithSameDate[dateInCurrentInput].push(this.currentDateTypeInput);\n      } else {\n        if ((0,Tools/* isUndefined */.o8)(this.inputsWithSameDate[dateInNextInput])) {\n          this.inputsWithSameDate[dateInNextInput] = [];\n          this.inputsWithSameDate[dateInNextInput].push(this.nextDateTypeInput);\n        }\n      }\n    }\n  }, {\n    key: "pushCurrentDateTypeInput",\n    value: function pushCurrentDateTypeInput() {\n      var dateInCurrentInput = this.currentDateTypeInput.value;\n\n      if ((0,Tools/* isUndefined */.o8)(this.inputsWithSameDate[dateInCurrentInput])) {\n        this.inputsWithSameDate[dateInCurrentInput] = [];\n        this.inputsWithSameDate[dateInCurrentInput].push(this.currentDateTypeInput);\n      }\n    }\n  }, {\n    key: "fetchLinesToRepeat",\n    value: function fetchLinesToRepeat() {\n      var _this3 = this;\n\n      (0,Tools/* loopOverObject */.Az)(this.inputsWithSameDate, function (date, inputs) {\n        (0,Tools/* foreachArrayElements */.$f)(inputs, function (input) {\n          _this3.pushIntoLinesToRepeatLinesWichAreNotExercise(input, date);\n        });\n      });\n    }\n  }, {\n    key: "pushIntoLinesToRepeatLinesWichAreNotExercise",\n    value: function pushIntoLinesToRepeatLinesWichAreNotExercise(input, date) {\n      var inputLine = input.parentElement.parentElement;\n      var inputTypeChapter = inputLine.querySelector(\'#chapter-input\');\n      var inputValue = inputTypeChapter.value;\n\n      if (inputValue.includes("exercice")) {\n        this.numberOfLinesOfExercise++;\n        this.numberOfLinesOfExercisePerDate[date] = this.numberOfLinesOfExercise;\n      } else {\n        if ((0,Tools/* isUndefined */.o8)(this.linesToRepeat[date])) {\n          this.linesToRepeat[date] = [];\n        }\n\n        this.linesToRepeat[date].push(inputTypeChapter.parentElement.parentElement);\n      }\n    }\n  }, {\n    key: "fetchRowsWithSameDate",\n    value: function fetchRowsWithSameDate() {\n      var _this4 = this;\n\n      var tableLines = (0,Tools/* createArray */.Ri)(this.modal.querySelector(\'tbody\').querySelectorAll(\'tr\'));\n      tableLines.forEach(function (line) {\n        var date = line.querySelector(\'#date-input\').value;\n        var hour = line.querySelector(\'#hour-input\').value;\n\n        if ((0,Tools/* isUndefined */.o8)(_this4.linesOfInputsWithSameDate[date])) {\n          _this4.linesOfInputsWithSameDate[date] = [];\n        }\n\n        _this4.linesOfInputsWithSameDate[date].push(line);\n      });\n    }\n  }, {\n    key: "spaceEveryRevisionsSpacedUnder2H",\n    value: function spaceEveryRevisionsSpacedUnder2H() {\n      this.countDate = 0;\n      this.lastCountDate = 0;\n\n      for (var date in this.linesOfInputsWithSameDate) {\n        this.currentRowsOfADate = this.linesOfInputsWithSameDate[date];\n        this.countDate++;\n\n        if ((0,Tools/* IsIterable */.bH)(this.currentRowsOfADate)) {\n          this.comparateTimeValuesInEachRow();\n        }\n\n        this.lastCountDate = this.countDate;\n      }\n    }\n  }, {\n    key: "comparateTimeValuesInEachRow",\n    value: function comparateTimeValuesInEachRow() {\n      if (!(0,Tools/* isUndefined */.o8)(this.currentRowsOfADate)) {\n        this.takeEachRowAndComparateWithOtherRows();\n      } else {\n        throw new Error("La propriété this.currentRowWithSameDate est undefined");\n      }\n    }\n  }, {\n    key: "takeEachRowAndComparateWithOtherRows",\n    value: function takeEachRowAndComparateWithOtherRows() {\n      var _this$currentRowsOfAD,\n          _this5 = this;\n\n      if ((0,Tools/* isUndefined */.o8)(this.countDate) || (0,Tools/* isUndefined */.o8)(this.lastCountDate)) {\n        throw new Error("Les propriétés this.countDate et this.lastCountDate ne peuvent pas être undefined.");\n      }\n\n      (_this$currentRowsOfAD = this.currentRowsOfADate) === null || _this$currentRowsOfAD === void 0 ? void 0 : _this$currentRowsOfAD.forEach(function (row) {\n        _this5.currentHourInput = row.querySelector(\'#hour-input\');\n\n        _this5.makeComparisonPerDate(row);\n      });\n    }\n    /**\r\n     * Fait en sorte que la comparaison ne se fasse que dans les lignes de même date.\r\n     * Fait la comparaison des heures à l\'intérieur de l\'input type=hour des lignes de même date. \r\n     * @param {HTMLTableRowElement} row\r\n     */\n\n  }, {\n    key: "makeComparisonPerDate",\n    value: function makeComparisonPerDate(row) {\n      if (this.currentRowIsOneStepAwayFromThePrecedent()) {\n        this.comparateCurrentWithDifferentOne(row);\n      }\n    }\n    /**\r\n     * \r\n     * @returns {boolean} la ligne courrante suit directement la précédente. Il n\'y a pas de saut ou autres\r\n     */\n\n  }, {\n    key: "currentRowIsOneStepAwayFromThePrecedent",\n    value: function currentRowIsOneStepAwayFromThePrecedent() {\n      return this.countDate === this.lastCountDate + 1;\n    }\n    /**\r\n     * \r\n     * @param {HTMLTableRowElement} row \r\n     */\n\n  }, {\n    key: "comparateCurrentWithDifferentOne",\n    value: function comparateCurrentWithDifferentOne(row) {\n      var _this$currentHourInpu,\n          _this6 = this;\n\n      this.splittedHourValueOfCurrentInput = (_this$currentHourInpu = this.currentHourInput) === null || _this$currentHourInpu === void 0 ? void 0 : _this$currentHourInpu.value.split(\':\');\n      this.currentRowsOfADate.forEach(function (parallelRow) {\n        if (row !== parallelRow) {\n          _this6.parallelRowHourInput = parallelRow.querySelector(\'#hour-input\');\n          _this6.splittedParallelRowHourInputValue = _this6.parallelRowHourInput.value.split(\':\');\n          _this6.currentRowHourValue = _this6.splittedHourValueOfCurrentInput[0];\n          _this6.currentRowMinutesValue = _this6.splittedHourValueOfCurrentInput[1];\n          _this6.parallelRowHourValue = _this6.splittedParallelRowHourInputValue[0];\n          _this6.parallelRowMinutesValue = _this6.splittedParallelRowHourInputValue[1];\n          _this6.currentAndLastInputsHoursDiff = parseInt(_this6.currentRowHourValue) - parseInt(_this6.parallelRowHourValue);\n          _this6.currentAndLastInputsMinutesDiff = parseInt(_this6.currentRowMinutesValue) - parseInt(_this6.parallelRowMinutesValue);\n\n          if (_this6.revisionsAreSpacedUnder2H()) {\n            _this6.spaceIsUnder2H = true;\n\n            _this6.modifyHour();\n          }\n        }\n      });\n    }\n    /**\r\n     * @returns boolean\r\n     * @throws {Error} si la variable this.currentAndLastInputsHoursDiff n\'est pas définie\r\n     * avant l\'appel de la fonction\r\n     */\n\n  }, {\n    key: "revisionsAreSpacedUnder2H",\n    value: function revisionsAreSpacedUnder2H() {\n      if (!(0,Tools/* isUndefined */.o8)(this.currentAndLastInputsHoursDiff)) {\n        return Math.abs(this.currentAndLastInputsHoursDiff) < 2 || this.fewMinutesMissedToComplete2H();\n      }\n\n      throw new Error("La variable this.currentAndLastInputsHoursDiff undefined");\n    }\n    /**\r\n     * \r\n     * @returns boolean\r\n     * @throws {Error} si les variables this.currentAndLastInputsMinutesDiff \r\n     * et this.currentAndLastInputsHoursDiff ne sont pas définies \r\n     * avant l\'appel de la fonction\r\n     */\n\n  }, {\n    key: "fewMinutesMissedToComplete2H",\n    value: function fewMinutesMissedToComplete2H() {\n      if (!(0,Tools/* isUndefined */.o8)(this.currentAndLastInputsHoursDiff) && !(0,Tools/* isUndefined */.o8)(this.currentAndLastInputsMinutesDiff)) {\n        return this.currentAndLastInputsHoursDiff < 0 && Math.abs(this.currentAndLastInputsHoursDiff) === 2 && this.currentAndLastInputsMinutesDiff > 0 || this.currentAndLastInputsHoursDiff > 0 && Math.abs(this.currentAndLastInputsHoursDiff) === 2 && this.currentAndLastInputsMinutesDiff < 0;\n      }\n\n      throw new Error("Les variables this.currentAndLastInputsHoursDiff et this.currentAndLastInputsMinutesDiff sont undefined");\n    }\n  }, {\n    key: "modifyHour",\n    value: function modifyHour() {\n      if (!(0,Tools/* isUndefined */.o8)(this.currentAndLastInputsHoursDiff) && !(0,Tools/* isUndefined */.o8)(this.currentAndLastInputsMinutesDiff)) {\n        if (this.currentRowHourValueIsSuperior()) {\n          this.AddNewHourValue(this.currentHourInput, {\n            hour: parseInt(this.currentRowHourValue) + 1,\n            minutes: this.parallelRowMinutesValue.length === 1 ? "0" + this.parallelRowMinutesValue : this.parallelRowMinutesValue\n          });\n        } else if (this.bothHoursValuesAreEquals()) {\n          if (this.currentAndLastInputsMinutesDiff > 0) {\n            this.AddNewHourValue(this.currentHourInput, {\n              hour: parseInt(this.currentRowHourValue) + 2,\n              minutes: this.parallelRowMinutesValue.length === 1 ? "0" + this.parallelRowMinutesValue : this.parallelRowMinutesValue\n            });\n          } else if (this.currentAndLastInputsMinutesDiff === 0) {\n            this.AddNewHourValue(this.parallelRowHourInput, {\n              hour: parseInt(this.currentRowHourValue) + 2,\n              minutes: this.parallelRowMinutesValue.length === 1 ? "0" + this.parallelRowMinutesValue : this.parallelRowMinutesValue\n            });\n          } else {\n            this.AddNewHourValue(this.parallelRowHourInput, {\n              hour: parseInt(this.parallelRowHourValue) + 2,\n              minutes: this.currentRowMinutesValue.length === 1 ? "0" + this.currentRowMinutesValue : this.currentRowMinutesValue\n            });\n          }\n        } else {\n          this.AddNewHourValue(this.parallelRowHourInput, {\n            hour: parseInt(this.parallelRowHourValue) + 1,\n            minutes: this.currentRowMinutesValue.length === 1 ? "0" + this.currentRowMinutesValue : this.currentRowMinutesValue\n          });\n        }\n      } else {\n        throw new Error("Les propriétés this.currentAndLastInputsHoursDiff et this.currentAndLastInputsMinutesDiff sont undefined");\n      }\n    }\n    /**\r\n     * \r\n     * @param {HTMLTableRowElement} hourInput \r\n     * @param {{hour: number, minutes: number}} time \r\n     */\n\n  }, {\n    key: "AddNewHourValue",\n    value: function AddNewHourValue(hourInput, time) {\n      hourInput.value = time.hour.toString().length > 1 ? time.hour.toString() + ":" + time.minutes : "0" + time.hour.toString() + ":" + time.minutes;\n    }\n  }, {\n    key: "currentRowHourValueIsSuperior",\n    value: function currentRowHourValueIsSuperior() {\n      return this.currentAndLastInputsHoursDiff > 0;\n    }\n  }, {\n    key: "bothHoursValuesAreEquals",\n    value: function bothHoursValuesAreEquals() {\n      return this.currentAndLastInputsHoursDiff === 0;\n    }\n  }, {\n    key: "pushRemoveButtonIfInRowActionButtonsToArray",\n    value: function pushRemoveButtonIfInRowActionButtonsToArray(rowActionButtons, array) {\n      if (document.querySelector(\'.remove_line_button\') in rowActionButtons) {\n        console.log(\'ok it\\\'s in\');\n      }\n    }\n  }]);\n\n  return calendarGenerationTools;\n}();\n\n\n;// CONCATENATED MODULE: ./src/AbstractClasses/CalendarCreationDOMInteractions.js\nfunction CalendarCreationDOMInteractions_typeof(obj) { "@babel/helpers - typeof"; return CalendarCreationDOMInteractions_typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, CalendarCreationDOMInteractions_typeof(obj); }\n\nfunction CalendarCreationDOMInteractions_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\nfunction CalendarCreationDOMInteractions_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction CalendarCreationDOMInteractions_createClass(Constructor, protoProps, staticProps) { if (protoProps) CalendarCreationDOMInteractions_defineProperties(Constructor.prototype, protoProps); if (staticProps) CalendarCreationDOMInteractions_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, "prototype", { writable: false }); return Constructor; }\n\nfunction _get() { if (typeof Reflect !== "undefined" && Reflect.get) { _get = Reflect.get.bind(); } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(arguments.length < 3 ? target : receiver); } return desc.value; }; } return _get.apply(this, arguments); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = CalendarCreationDOMInteractions_getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction CalendarCreationDOMInteractions_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, "prototype", { writable: false }); if (superClass) CalendarCreationDOMInteractions_setPrototypeOf(subClass, superClass); }\n\nfunction CalendarCreationDOMInteractions_setPrototypeOf(o, p) { CalendarCreationDOMInteractions_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return CalendarCreationDOMInteractions_setPrototypeOf(o, p); }\n\nfunction CalendarCreationDOMInteractions_createSuper(Derived) { var hasNativeReflectConstruct = CalendarCreationDOMInteractions_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = CalendarCreationDOMInteractions_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = CalendarCreationDOMInteractions_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return CalendarCreationDOMInteractions_possibleConstructorReturn(this, result); }; }\n\nfunction CalendarCreationDOMInteractions_possibleConstructorReturn(self, call) { if (call && (CalendarCreationDOMInteractions_typeof(call) === "object" || typeof call === "function")) { return call; } else if (call !== void 0) { throw new TypeError("Derived constructors may only return object or undefined"); } return CalendarCreationDOMInteractions_assertThisInitialized(self); }\n\nfunction CalendarCreationDOMInteractions_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called"); } return self; }\n\nfunction CalendarCreationDOMInteractions_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction CalendarCreationDOMInteractions_getPrototypeOf(o) { CalendarCreationDOMInteractions_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return CalendarCreationDOMInteractions_getPrototypeOf(o); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\n\n\n\n\n\n\n\nvar CalendarCreationDOMInteractions = /*#__PURE__*/function (_DOMInteractions) {\n  CalendarCreationDOMInteractions_inherits(CalendarCreationDOMInteractions, _DOMInteractions);\n\n  var _super = CalendarCreationDOMInteractions_createSuper(CalendarCreationDOMInteractions);\n\n  function CalendarCreationDOMInteractions() {\n    var _this;\n\n    CalendarCreationDOMInteractions_classCallCheck(this, CalendarCreationDOMInteractions);\n\n    _this = _super.call(this);\n\n    _defineProperty(CalendarCreationDOMInteractions_assertThisInitialized(_this), "formAction", \'/create-calendar\');\n\n    _defineProperty(CalendarCreationDOMInteractions_assertThisInitialized(_this), "notificationClassName", \'calendar_creation_notification\');\n\n    _this.actionsButtonsPerRow = {};\n    _this.atLeastOneRowIsExercise = 4;\n    _this.atLeastTwoRowsAreExercises = 5;\n    _this.repetitionLinesHaveBeenCreated = false;\n    _this.tableLinesLengthOfCalendarCreationLines = 1;\n    _this.normalDailyNumberOfSubjects = 3;\n    _this.numberOfRepetitions = 5;\n    _this.createdLines = 0;\n    _this.currentRowToRepeat;\n    _this.isQuotaError = false;\n    _this.isWarning = false;\n    _this.messageForQuotaErrorOne = "Erreur du quota 3 matières/j. Il faut au moins que l\'une d\'entre elles soient un exercice.";\n    _this.messageForQuotaErrorTwo = "Erreur du quota 3 matières/j. Il faut au moins que deux d\'entre elles soient un exercice.";\n    _this.currentQuotaErrorMessageToShow;\n    _this.repetition = new Repetition();\n    _this.date = new RepetitionDate();\n    return _this;\n  }\n\n  CalendarCreationDOMInteractions_createClass(CalendarCreationDOMInteractions, [{\n    key: "handleActionsInModalForm",\n    value: function handleActionsInModalForm() {\n      _get(CalendarCreationDOMInteractions_getPrototypeOf(CalendarCreationDOMInteractions.prototype), "handleActionsInModalForm", this).call(this);\n\n      this.toolsForCalendarGeneration = new calendarGenerationTools();\n      this.handleAddLineButtonClick();\n      this.handleCalendarGeneration();\n    }\n  }, {\n    key: "handleAddLineButtonClick",\n    value: function handleAddLineButtonClick() {\n      var addLineButton = this.modal.querySelector(\'.add-line\');\n      addLineButton.addEventListener(\'click\', this.appendNewLineToCalendarCreationTable.bind(this));\n    }\n  }, {\n    key: "appendNewLineToCalendarCreationTable",\n    value: function appendNewLineToCalendarCreationTable(e) {\n      this.createLine();\n      this.handleRemoveLineButtonClick();\n      this.removeRowActionMenuIfExists(e);\n      this.handleCalendarGeneration();\n      this.handleAddLineButtonClick();\n    }\n  }, {\n    key: "createLine",\n    value: function createLine() {\n      this.tableLinesLengthOfCalendarCreationLines++;\n      this.currentCreatedLine = this.createElement(\'tr\', \'subject-line\');\n      var removeLineButton = this.modal.querySelector(\'.remove-line\');\n      var addLineButton = this.modal.querySelector(\'.add-line\');\n      var subjectLine;\n      var generateCalendarButton;\n\n      if (addLineButton) {\n        this.addLineButtonContainer = addLineButton.parentElement;\n        subjectLine = this.addLineButtonContainer.parentElement;\n        generateCalendarButton = subjectLine.querySelector(\'.generate-calendar\');\n        this.generateCalendarButtonContainer = generateCalendarButton.parentElement;\n      }\n\n      this.calendarCreationTbody = this.modal.querySelector(\'.calendar-creation-tbody\');\n\n      if (removeLineButton !== null) {\n        removeLineButton.parentElement.parentElement.removeChild(removeLineButton.parentElement);\n      }\n\n      this.calendarCreationTbody.appendChild(this.currentCreatedLine);\n      var currentCreatedLineInnerHTML = "\\n        <td><input type=\'text\' name=\'subject-".concat(this.tableLinesLengthOfCalendarCreationLines, "\' id=\'subject-input\'></td>\\n        <td><input type=\'text\' name=\'chapter-").concat(this.tableLinesLengthOfCalendarCreationLines, "\' id=\'chapter-input\'></td>\\n        <td><input type=\'date\' name=\'date-").concat(this.tableLinesLengthOfCalendarCreationLines, "\' id=\'date-input\'></td>\\n        <td><input type=\'time\' name=\'hour-").concat(this.tableLinesLengthOfCalendarCreationLines, "\' id=\'hour-input\'></td>\\n        ");\n\n      if (!this.repetitionLinesHaveBeenCreated) {\n        currentCreatedLineInnerHTML += "\\n            <td class=\'row_action_button add_line_button\'><i class=\'fas fa-plus add-line\'></i></td>\\n            <td class=\'row_action_button generate_calendar_button\'><i class=\'fas fa-check generate-calendar\'></i></td>\\n            <td class=\'row_action_button remove_line_button\'><i class=\'fas fa-window-close remove-line\'></i></td>\\n            ";\n      }\n\n      this.currentCreatedLine.innerHTML = currentCreatedLineInnerHTML;\n\n      if (window.innerWidth <= 800) {\n        this.appendRowActionButtonsIntoAMenu();\n      } else {\n        if (!(0,Tools/* isUndefined */.o8)(subjectLine)) {\n          subjectLine.removeChild(this.addLineButtonContainer);\n          subjectLine.removeChild(this.generateCalendarButtonContainer);\n        }\n      }\n\n      this.growFormHeight();\n      this.growModalHeight();\n      this.growBodyHeightIfModalCollapse();\n    }\n  }, {\n    key: "handleRemoveLineButtonClick",\n    value: function handleRemoveLineButtonClick() {\n      this.removeLineButton = this.modal.querySelector(\'.remove-line\');\n\n      if (this.removeLineButton !== null) {\n        this.handleClickOnRemoveLineButton();\n      }\n    }\n  }, {\n    key: "handleClickOnRemoveLineButton",\n    value: function handleClickOnRemoveLineButton() {\n      var _this2 = this;\n\n      this.removeLineButton.addEventListener(\'click\', function (e) {\n        _this2.tableLinesLengthOfCalendarCreationLines--;\n        _this2.removeLineButtonContainer = _this2.removeLineButton.parentNode;\n        var removeLineButtonContainerParent = _this2.removeLineButtonContainer.parentNode;\n\n        if ((0,DOMTools/* elementHasClassName */.cF)(removeLineButtonContainerParent, \'action_menu\')) {\n          (0,DOMTools/* removeElementFromDOM */.e5)(removeLineButtonContainerParent.previousElementSibling);\n          (0,DOMTools/* removeElementFromDOM */.e5)(removeLineButtonContainerParent.parentElement);\n\n          _this2.removeRowActionMenu(removeLineButtonContainerParent);\n\n          _this2.appendToLastRowActionButtons();\n\n          _this2.appendRowActionButtonsIntoAMenu();\n        } else {\n          removeLineButtonContainerParent.classList.add(\'invisible-subject-line\');\n          removeLineButtonContainerParent.addEventListener(\'animationend\', function () {\n            _this2.calendarCreationTbody.removeChild(removeLineButtonContainerParent);\n\n            _this2.appendToLastRowActionButtons();\n          });\n        }\n      });\n    }\n  }, {\n    key: "appendToLastRowActionButtons",\n    value: function appendToLastRowActionButtons() {\n      this.calendarCreationTbody.lastElementChild.appendChild(this.addLineButtonContainer);\n      this.calendarCreationTbody.lastElementChild.appendChild(this.generateCalendarButtonContainer);\n\n      if (this.calendarCreationTbody.firstElementChild !== this.calendarCreationTbody.lastElementChild) {\n        this.calendarCreationTbody.lastElementChild.appendChild(this.removeLineButtonContainer);\n      }\n\n      this.reduceFormHeightUntilNormal();\n      this.reduceModalHeightUntilNormal();\n      this.reduceBodyHeigthUntilNormal();\n    }\n  }, {\n    key: "growFormHeight",\n    value: function growFormHeight() {\n      this.growElementSize(this.modalForm, {\n        attribute: \'height\',\n        value: this.modalForm.offsetHeight + this.currentCreatedLine.offsetHeight\n      });\n    }\n  }, {\n    key: "growModalHeight",\n    value: function growModalHeight() {\n      this.growElementSize(this.modal, {\n        attribute: \'height\',\n        value: this.modal.offsetHeight + this.currentCreatedLine.offsetHeight\n      });\n    }\n    /**\r\n     * \r\n     * @param {HTMLElement} element \r\n     * @param {{attribute: string, value: number}} options \r\n     */\n\n  }, {\n    key: "growElementSize",\n    value: function growElementSize(element, options) {\n      if (options.attribute === \'width\') {\n        element.style.width = options.value + \'px\';\n      } else {\n        element.style.height = options.value + \'px\';\n      }\n    }\n  }, {\n    key: "growBodyHeightIfModalCollapse",\n    value: function growBodyHeightIfModalCollapse() {\n      if (this.modal.offsetHeight >= 470) {\n        this.growElementSize(document.body, {\n          attribute: \'height\',\n          value: document.body.offsetHeight + this.currentCreatedLine.offsetHeight\n        });\n      }\n    }\n  }, {\n    key: "reduceFormHeightUntilNormal",\n    value: function reduceFormHeightUntilNormal() {\n      var modalFormHeight = this.modalForm.offsetHeight;\n\n      if (modalFormHeight > this.originalModalFormHeigth) {\n        this.modalForm.style.height = modalFormHeight - this.modal.querySelector(\'tr\').offsetHeight + \'px\';\n      }\n    }\n  }, {\n    key: "reduceModalHeightUntilNormal",\n    value: function reduceModalHeightUntilNormal() {\n      if (this.modal.offsetHeight > this.originalModalHeigth) {\n        this.modal.style.height = this.modal.offsetHeight - this.modal.querySelector(\'tr\').offsetHeight + \'px\';\n      }\n    }\n  }, {\n    key: "reduceBodyHeigthUntilNormal",\n    value: function reduceBodyHeigthUntilNormal() {\n      if (document.body.offsetHeight > this.originalBodyHeight) {\n        document.body.style.height = document.body.offsetHeight - this.modal.querySelector(\'tr\').offsetHeight + \'px\';\n      }\n    }\n  }, {\n    key: "handleCalendarGeneration",\n    value: function handleCalendarGeneration() {\n      var generateCalendarButton = this.modal.querySelector(\'.generate-calendar\');\n      generateCalendarButton === null || generateCalendarButton === void 0 ? void 0 : generateCalendarButton.addEventListener(\'click\', this.generateCalendar.bind(this));\n    }\n  }, {\n    key: "generateCalendar",\n    value: function generateCalendar(e) {\n      this.toolsForCalendarGeneration.fillInputsWithSameDate();\n      this.toolsForCalendarGeneration.fetchLinesToRepeat();\n      this.generateLinesOfRepetitions();\n      this.removeRowActionMenuIfExists(e);\n      this.toolsForCalendarGeneration.fetchRowsWithSameDate();\n\n      try {\n        this.toolsForCalendarGeneration.spaceEveryRevisionsSpacedUnder2H();\n      } catch (error) {\n        console.error(error);\n      }\n    }\n  }, {\n    key: "generateLinesOfRepetitions",\n    value: function generateLinesOfRepetitions() {\n      var _this3 = this;\n\n      (0,Tools/* loopOverObject */.Az)(this.toolsForCalendarGeneration.inputsWithSameDate, function (date, inputs) {\n        _this3.numberOfSubjectsIsNormal(inputs, date);\n\n        _this3.numberOfSubjectsMoreThanNormal(inputs, date);\n      });\n    }\n  }, {\n    key: "numberOfSubjectsIsNormal",\n    value: function numberOfSubjectsIsNormal(inputs, date) {\n      var _this4 = this;\n\n      if (inputs.length < this.atLeastOneRowIsExercise && this.toolsForCalendarGeneration.linesToRepeat[date] !== undefined) {\n        this.toolsForCalendarGeneration.linesToRepeat[date].forEach(function (row) {\n          _this4.currentRowToRepeat = row;\n\n          _this4.generateRepetitionsCalendar(row);\n        });\n      }\n    }\n  }, {\n    key: "numberOfSubjectsMoreThanNormal",\n    value: function numberOfSubjectsMoreThanNormal(inputs, date) {\n      switch (inputs.length) {\n        case this.atLeastOneRowIsExercise:\n          this.generateRepetitionsOrShowWarningOne(date);\n          break;\n\n        case this.atLeastTwoRowsAreExercises:\n          this.generateRepetitionsOrShowWarningTwo(date);\n          break;\n      }\n    }\n  }, {\n    key: "generateRepetitionsOrShowWarningOne",\n    value: function generateRepetitionsOrShowWarningOne(date) {\n      this.currentQuotaErrorMessageToShow = this.messageForQuotaErrorOne;\n      this.generateRepetitionsOrShowWarning(date);\n    }\n  }, {\n    key: "generateRepetitionsOrShowWarningTwo",\n    value: function generateRepetitionsOrShowWarningTwo(date) {\n      this.currentQuotaErrorMessageToShow = this.messageForQuotaErrorTwo;\n      this.generateRepetitionsOrShowWarning(date);\n    }\n  }, {\n    key: "generateRepetitionsOrShowWarning",\n    value: function generateRepetitionsOrShowWarning(date) {\n      var _this5 = this;\n\n      if (this.toolsForCalendarGeneration.numberOfLinesOfExercisePerDate[date] >= 1) {\n        if (!this.isQuotaError) {\n          (0,Tools/* foreachArrayElements */.$f)(this.toolsForCalendarGeneration.linesToRepeat[date], function (line) {\n            _this5.currentRowToRepeat = line;\n\n            _this5.generateRepetitionsCalendar(line);\n          });\n        }\n      } else {\n        this.showWarning(date);\n      }\n    }\n  }, {\n    key: "showWarning",\n    value: function showWarning(date) {\n      this.isQuotaError = true;\n      this.focusChapterInputOn(this.toolsForCalendarGeneration.linesToRepeat[date]);\n      this.createWarning(this.currentQuotaErrorMessageToShow);\n    }\n    /**\r\n     * \r\n     * @param {HTMLTableRowElement[]} linesToRepeatOfADate \r\n     */\n\n  }, {\n    key: "focusChapterInputOn",\n    value: function focusChapterInputOn(linesToRepeatOfADate) {\n      var _this6 = this;\n\n      (0,Tools/* foreachArrayElements */.$f)(linesToRepeatOfADate, function (line) {\n        _this6.alertFocusOnElement(line.querySelector(\'#chapter-input\'));\n      });\n    }\n    /**\r\n     * \r\n     * @param {HTMLTableRowElement} row \r\n     */\n\n  }, {\n    key: "generateRepetitionsCalendar",\n    value: function generateRepetitionsCalendar(row) {\n      var rowInputs = row.querySelectorAll(\'input\');\n      var emptyInputExists = false;\n      rowInputs.forEach(function (input) {\n        if (input.value === \'\') {\n          emptyInputExists = true;\n        }\n      });\n\n      if (!emptyInputExists) {\n        this.repetitionLinesHaveBeenCreated = true;\n        this.generateLines(row);\n      } else {\n        if (document.querySelector(\'.warning\') === null) {\n          this.isWarning = true;\n          this.createWarning("Impossible de générer les répétitions si les champs sont vides.");\n        }\n      }\n    }\n    /**\r\n     * \r\n     * @param {HTMLTableRowElement} row \r\n     */\n\n  }, {\n    key: "generateLines",\n    value: function generateLines(row) {\n      for (var i = 1; i <= this.numberOfRepetitions; i++) {\n        this.createLine();\n        this.createdLines = i;\n        this.generateInputsValue();\n      }\n    }\n    /**\r\n     * \r\n     * @param {HTMLElement} element IL FAUT REGLER CECI CAR CET ELEMENT RESTE L\'ELEMENT INITIAL\r\n     */\n\n  }, {\n    key: "generateInputsValue",\n    value: function generateInputsValue() {\n      var _this$currentRowToRep, _this$currentRowToRep2, _this$currentRowToRep3, _this$currentRowToRep4;\n\n      var tbody = document.querySelector(\'tbody\');\n      var tbodyLastChild = tbody.lastElementChild;\n      var subjectInput = tbodyLastChild.querySelector(\'#subject-input\');\n      var chapterInput = tbodyLastChild.querySelector(\'#chapter-input\');\n      var dateInput = tbodyLastChild.querySelector(\'#date-input\');\n      var hourInput = tbodyLastChild.querySelector(\'#hour-input\');\n      subjectInput.value = (_this$currentRowToRep = this.currentRowToRepeat) === null || _this$currentRowToRep === void 0 ? void 0 : _this$currentRowToRep.querySelector(\'#subject-input\').value;\n      chapterInput.value = (_this$currentRowToRep2 = this.currentRowToRepeat) === null || _this$currentRowToRep2 === void 0 ? void 0 : _this$currentRowToRep2.querySelector(\'#chapter-input\').value;\n      /**\r\n       * @type {[string, string]}\r\n       */\n\n      var splittedHour = (_this$currentRowToRep3 = this.currentRowToRepeat) === null || _this$currentRowToRep3 === void 0 ? void 0 : _this$currentRowToRep3.querySelector(\'#hour-input\').value.split(\':\');\n      var splittedDate = (_this$currentRowToRep4 = this.currentRowToRepeat) === null || _this$currentRowToRep4 === void 0 ? void 0 : _this$currentRowToRep4.querySelector(\'#date-input\').value.split(\'-\');\n      var year = splittedDate[0];\n      var month = splittedDate[1];\n      var day = splittedDate[2];\n      var hoursForNextRepetitions = this.repetition.hoursForNextRepetitions[this.createdLines];\n      var hourBetweenCurrentAndNextRepetition = hoursForNextRepetitions[0];\n      var hourForNexRepetition = parseInt(splittedHour[0], 10) + hourBetweenCurrentAndNextRepetition;\n\n      if (this.createdLines === 1) {\n        if (hourForNexRepetition < 20) {\n          var _this$currentRowToRep5;\n\n          dateInput.value = (_this$currentRowToRep5 = this.currentRowToRepeat) === null || _this$currentRowToRep5 === void 0 ? void 0 : _this$currentRowToRep5.querySelector(\'#date-input\').value;\n          hourInput.value = hourForNexRepetition.toString(10).length === 1 ? "0" + hourForNexRepetition + \':\' + splittedHour[1] : hourForNexRepetition + \':\' + splittedHour[1];\n        } else {\n          var intNewDayValue = parseInt(day) + 1;\n          var newDayValue = intNewDayValue.toString().length === 1 ? \'0\' + intNewDayValue.toString() : intNewDayValue;\n          hourForNexRepetition = 8;\n          dateInput.value = year + \'-\' + month + \'-\' + newDayValue;\n\n          if (dateInput.value === \'\') {\n            var intMonth = parseInt(month);\n\n            if (intMonth < 12) {\n              dateInput.value = year + \'-0\' + (intMonth + 1) + \'-\' + \'01\';\n            } else {\n              dateInput.value = parseInt(year) + 1 + \'-\' + \'01\' + \'-\' + \'01\';\n            }\n          }\n\n          hourInput.value = \'0\' + hourForNexRepetition + \':\' + splittedHour[1];\n        }\n      } else {\n        var intDay = parseInt(day);\n\n        var _intNewDayValue = intDay + hoursForNextRepetitions[1];\n\n        var _newDayValue = _intNewDayValue.toString().length === 1 ? \'0\' + _intNewDayValue.toString() : _intNewDayValue;\n\n        dateInput.value = year + \'-\' + month + \'-\' + _newDayValue;\n\n        if (dateInput.value === \'\') {\n          var _intMonth = parseInt(month);\n\n          var intDayInNextMonth = _intNewDayValue - this.date.numberOfDaysPerMonth[_intMonth];\n          var dayInNextMonth = intDayInNextMonth.toString().length === 1 ? "0" + intDayInNextMonth : intDayInNextMonth;\n\n          if (_intMonth < 12) {\n            dateInput.value = year + \'-0\' + (_intMonth + 1) + \'-\' + dayInNextMonth;\n          } else {\n            dateInput.value = parseInt(year) + 1 + \'-\' + \'01\' + \'-\' + \'01\';\n          }\n        }\n\n        hourInput.value = splittedHour[0] + \':\' + splittedHour[1];\n      }\n\n      this.currentRowToRepeat = tbodyLastChild;\n    }\n  }, {\n    key: "createWarning",\n    value: function createWarning(message) {\n      var warningParagraph = this.createElement(\'p\', \'warning\');\n      var i = this.createElement(\'i\', \'fas fa-exclamation-triangle\');\n      var span = this.createElement(\'span\', \'warning-message\');\n      warningParagraph.appendChild(i);\n      warningParagraph.appendChild(span);\n      span.innerHTML = message;\n      this.modal.querySelector(\'button\').before(warningParagraph);\n      warningParagraph.offsetWidth;\n      warningParagraph.classList.add(\'active_warning\');\n      var marginBottom = 30;\n      this.modal.style.height = this.modal.offsetHeight + warningParagraph.offsetHeight + marginBottom + \'px\';\n      this.removeElementAfterMilliseconds(warningParagraph, 5000, {\n        classNameToRemove: \'active_warning\',\n        elementWithHeightToDecrease: [this.modal, warningParagraph.offsetHeight + marginBottom]\n      });\n    }\n  }, {\n    key: "postContentWithNotificationThenReload",\n    value: function postContentWithNotificationThenReload() {\n      var _this7 = this;\n\n      (0,ajax/* post */.v)(this.formAction, this.dataToPostObj).then(function (response) {\n        _this7.handleRequestResponse(response);\n      }).catch(function (error) {\n        console.error("Il y a eu une erreur :" + error);\n      });\n    }\n  }, {\n    key: "handleRequestResponse",\n    value: function handleRequestResponse(response) {\n      var responseJson = JSON.parse(response);\n      var message = responseJson.success !== undefined ? responseJson.success : responseJson.fail;\n      this.showNotificationWithDataInMilliseconds({\n        className: this.notificationClassName,\n        content: message\n      }, 2000);\n      this.reloadPage();\n    }\n  }, {\n    key: "closeModal",\n    value: function closeModal() {\n      _get(CalendarCreationDOMInteractions_getPrototypeOf(CalendarCreationDOMInteractions.prototype), "closeModal", this).call(this);\n\n      document.body.style.height = this.originalBodyHeight + \'px\';\n    }\n  }, {\n    key: "removeRowActionMenuIfExists",\n    value: function removeRowActionMenuIfExists(e) {\n      var clickedButtonGrandParent = e.currentTarget.parentElement.parentElement;\n\n      if (clickedButtonGrandParent && (0,DOMTools/* elementHasClassName */.cF)(clickedButtonGrandParent, \'action_menu\') && !this.isWarning) {\n        this.removeRowActionMenu(clickedButtonGrandParent);\n      }\n    }\n  }, {\n    key: "removeRowActionMenu",\n    value: function removeRowActionMenu(rowActionMenu) {\n      this.hideRowActionMenu(rowActionMenu);\n      var rowActionMenuButton = rowActionMenu.parentNode.querySelector(\'.action_menu_button\');\n\n      if (rowActionMenuButton) {\n        (0,DOMTools/* removeElementFromDOM */.e5)(rowActionMenuButton);\n      }\n\n      (0,DOMTools/* removeElementFromDOM */.e5)(rowActionMenu);\n    }\n  }, {\n    key: "handleModalResponsive",\n    value: function handleModalResponsive() {\n      new modalResize(this);\n    }\n  }, {\n    key: "appendRowActionButtonsIntoAMenu",\n    value: function appendRowActionButtonsIntoAMenu() {\n      if ((this.modal.querySelector(\'.action_menu_button\') === null || this.lastSubjectRow !== null) && !this.repetitionLinesHaveBeenCreated) {\n        this.subjectRows = (0,Tools/* createArray */.Ri)(this.modal.querySelectorAll(\'.subject-line\'));\n        this.lastSubjectRowIndex = this.subjectRows.length - 1;\n        this.lastSubjectRow = this.subjectRows[this.lastSubjectRowIndex];\n        var rowActionButtons = (0,Tools/* createArray */.Ri)(this.lastSubjectRow.querySelectorAll(\'.row_action_button\'));\n        this.actionsButtonsPerRow[this.lastSubjectRowIndex] = rowActionButtons;\n        this.createMenuForLastRow();\n      } else if (this.repetitionLinesHaveBeenCreated) {\n        this.lastSubjectRow = null;\n        this.rowActionMenuButton = null;\n        this.actionMenu = null;\n      }\n    }\n  }, {\n    key: "createMenuForLastRow",\n    value: function createMenuForLastRow() {\n      this.createActionMenuButton(this.lastSubjectRow);\n      this.createMenuInRowThenAppendChildren(this.lastSubjectRow, this.actionsButtonsPerRow[this.lastSubjectRowIndex]);\n    }\n    /**\r\n     * \r\n     * @param {HTMLTableRowElement} row \r\n     */\n\n  }, {\n    key: "createActionMenuButton",\n    value: function createActionMenuButton(row) {\n      this.rowActionMenuButton = row.querySelector(\'.action_menu_button\');\n\n      if ((0,Tools/* isUndefined */.o8)(this.rowActionMenuButton) || this.rowActionMenuButton === null) {\n        this.rowActionMenuButton = this.createElement(\'td\', \'action_menu_button\');\n        this.rowActionMenuButton.innerHTML = "<p class=\'hot_dog_menu_circle\'></p>\\n            <p class=\'hot_dog_menu_circle\'></p>\\n            <p class=\'hot_dog_menu_circle\'></p>";\n        row.appendChild(this.rowActionMenuButton);\n        this.rowActionMenuButton.addEventListener(\'click\', this.toggleActionMenuOfTheRow.bind(this, row));\n      }\n    }\n    /**\r\n     * \r\n     * @param {HTMLTableRowElement} row \r\n     */\n\n  }, {\n    key: "createMenuInRowThenAppendChildren",\n    value: function createMenuInRowThenAppendChildren(row, futurChildren) {\n      var _this8 = this;\n\n      this.actionMenu = this.createElement(\'div\', \'action_menu\');\n      futurChildren.forEach(function (futurChild) {\n        _this8.actionMenu.appendChild(futurChild);\n      });\n      this.actionMenu.setAttribute(\'hidden\', \'true\');\n      row.appendChild(this.actionMenu);\n    }\n    /**\r\n     * \r\n     * @param {HTMLTableRowElement} row \r\n     */\n\n  }, {\n    key: "toggleActionMenuOfTheRow",\n    value: function toggleActionMenuOfTheRow(row) {\n      var rowActionMenu = row.lastElementChild;\n\n      if (rowActionMenu.hasAttribute(\'hidden\')) {\n        this.showRowActionMenu(rowActionMenu);\n      } else {\n        this.hideRowActionMenu(rowActionMenu);\n      }\n    }\n  }, {\n    key: "showRowActionMenu",\n    value: function showRowActionMenu(rowActionMenu) {\n      rowActionMenu.removeAttribute(\'hidden\');\n      rowActionMenu.offsetWidth;\n      rowActionMenu.classList.add(\'visible_action_menu\');\n\n      if (rowActionMenu.children.length === 3) {\n        rowActionMenu.classList.add(\'three_children\');\n      }\n    }\n  }, {\n    key: "hideRowActionMenu",\n    value: function hideRowActionMenu(rowActionMenu) {\n      rowActionMenu.classList.remove(\'visible_action_menu\');\n\n      var handleTransitionEnd = function handleTransitionEnd() {\n        rowActionMenu.setAttribute(\'hidden\', \'true\');\n\n        if ((0,DOMTools/* elementHasClassName */.cF)(rowActionMenu, \'three_children\')) {\n          rowActionMenu.classList.remove(\'three_children\');\n        }\n\n        rowActionMenu.removeEventListener(\'transitionend\', handleTransitionEnd);\n      };\n\n      rowActionMenu.addEventListener(\'transitionend\', handleTransitionEnd);\n    }\n  }, {\n    key: "getRowActionButtonsOutOfMenu",\n    value: function getRowActionButtonsOutOfMenu() {\n      if (this.actionMenuExists()) {\n        this.appendActionButtonsInParentRow();\n\n        if (this.actionMenu !== null && !(0,Tools/* isUndefined */.o8)(this.actionMenu)) {\n          (0,DOMTools/* removeElementFromDOM */.e5)(this.actionMenu);\n          (0,DOMTools/* removeElementFromDOM */.e5)(this.rowActionMenuButton);\n        }\n      }\n    }\n  }, {\n    key: "actionMenuExists",\n    value: function actionMenuExists() {\n      return this.lastSubjectRow !== null && this.rowActionMenuButton !== null && this.actionMenu !== null;\n    }\n  }, {\n    key: "appendActionButtonsInParentRow",\n    value: function appendActionButtonsInParentRow() {\n      var _this9 = this;\n\n      this.actionsButtonsPerRow[this.lastSubjectRowIndex].forEach(function (actionButton) {\n        _this9.subjectRows[_this9.lastSubjectRowIndex].appendChild(actionButton);\n      });\n    }\n  }, {\n    key: "alertEmptyInputs",\n    value: function alertEmptyInputs() {\n      var _this10 = this;\n\n      this.modalInputs.forEach(function (input) {\n        if (_this10.isMessageCorrespondsTo(input.name)) {\n          _this10.alertFocusOnElement(input);\n\n          _this10.removeAlertFocusWhenclick(input);\n        }\n      });\n    }\n  }]);\n\n  return CalendarCreationDOMInteractions;\n}(DOMInteractions/* default */.Z);\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTA1LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUVBO0FBQUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQVFBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFJQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDakRBOzs7OztBQUVBO0FBQ0E7O0FBQUE7O0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVpBO0FBSEE7QUFpQkE7OztBQXBCQTs7Ozs7Ozs7OztBQ0NBO0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQVhBO0FBQUE7QUFBQTtBQWVBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF2QkE7O0FBQUE7QUFBQTs7Ozs7Ozs7OztBQ0RBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7OztBQUVBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFBQTs7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFDQTtBQUNBO0FBQUE7O0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTs7QUFHQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBQ0E7QUFFQTtBQUdBO0FBS0E7O0FBRUE7QUFDQTs7O0FBRUE7QUFFQTtBQUlBO0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFPQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBQ0E7QUFFQTtBQUdBOzs7QUFFQTtBQUVBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDL1ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7Ozs7O0FBSUE7QUFDQTs7QUFBQTs7QUFDQTs7QUFEQTs7QUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpCQTtBQWtCQTs7OztBQUVBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQU1BO0FBQ0E7QUFLQTs7QUFFQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUVBOztBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFJQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBOzs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTs7QUFDQTtBQUNBOztBQUNBO0FBRUE7QUFDQTs7O0FBRUE7QUFDQTs7QUFDQTtBQUlBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFRQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFDQTtBQUFBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBQ0E7QUFBQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUFBOztBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQUNBOztBQUNBOztBQUNBOztBQUVBOztBQUNBO0FBQ0E7O0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTs7QUFFQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFGQTtBQUlBOzs7QUFFQTtBQUNBOztBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFLQTtBQUNBOzs7QUFFQTtBQUVBOztBQUNBO0FBQ0E7OztBQUVBO0FBRUE7O0FBQ0E7QUFJQTtBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7O0FBRUE7QUFFQTtBQUNBOzs7QUFFQTtBQUVBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUVBOztBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7O0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBOzs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQTVtQkEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJwYWNrLWRlbW8vLi9zcmMvUmVwZXRpdGlvbnNHZW5lcmF0aW9uL1JlcGV0aXRpb24uanM/ZTcyMCIsIndlYnBhY2s6Ly93ZWJwYWNrLWRlbW8vLi9zcmMvUmVwZXRpdGlvbnNHZW5lcmF0aW9uL1JlcGV0aXRpb25EYXRlLmpzP2ZlZGUiLCJ3ZWJwYWNrOi8vd2VicGFjay1kZW1vLy4vc3JjL3Jlc3BvbnNpdmVzL21vZGFsUmVzaXplLmpzP2I0NGIiLCJ3ZWJwYWNrOi8vd2VicGFjay1kZW1vLy4vc3JjL0Fic3RyYWN0Q2xhc3Nlcy9Ub29scy9jYWxlbmRhckdlbmVyYXRpb25Ub29scy5qcz9lOThiIiwid2VicGFjazovL3dlYnBhY2stZGVtby8uL3NyYy9BYnN0cmFjdENsYXNzZXMvQ2FsZW5kYXJDcmVhdGlvbkRPTUludGVyYWN0aW9ucy5qcz9iZDQxIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlcGV0aXRpb24ge1xyXG4gICAgXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJvcGVydHkgaG91cnNGb3JOZXh0UmVwZXRpdGlvbnMgaW5kZXjDqSBwYXIgbGVzIHJhbmdzIGRlIHLDqXDDqXRpdGlvbnNcclxuICAgICAgICAgKiBAdHlwZSB7e251bWJlcjogW251bWJlciwgbnVtYmVyXSxcclxuICAgICAgICAgKiBudW1iZXI6IFtudW1iZXIsIG51bWJlcl0sIG51bWJlcjogW251bWJlciwgbnVtYmVyXSxcclxuICAgICAgICAgKiBudW1iZXI6IFtudW1iZXIsIG51bWJlcl0sIG51bWJlcjogW251bWJlciwgbnVtYmVyXVxyXG4gICAgICAgICAqIH19XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5ob3Vyc0Zvck5leHRSZXBldGl0aW9ucyA9IHtcclxuICAgICAgICAgICAgMTogWzgsIDBdLFxyXG4gICAgICAgICAgICAyOiBbMjQsIDFdLFxyXG4gICAgICAgICAgICAzOiBbMjQqNywgN10sXHJcbiAgICAgICAgICAgIDQ6IFsyNyo3KjIsIDE0XSxcclxuICAgICAgICAgICAgNTogWzI0KjMwLCAzMF1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEB0eXBlIHt7bW9ybmluZzogW251bWJlciwgbnVtYmVyXSwgYWZ0ZXJub29uOiBbbnVtYmVyLCBudW1iZXJdfX1cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmhvdXJzSW5BRGF5ID0ge1xyXG4gICAgICAgICAgICBtb3JuaW5nIDogWzgsIDExLjMwXSxcclxuICAgICAgICAgICAgYWZ0ZXJub29uOiBbMTQsIDIwXVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG5ld0hvdXJWYWx1ZSBcclxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59XHJcbiAgICAgKi9cclxuICAgIGlzQmVmb3JlV29ya1RpbWUobmV3SG91clZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ld0hvdXJWYWx1ZSA8IHRoaXMuaG91cnNJbkFEYXkubW9ybmluZ1swXVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbmV3SG91clZhbHVlIFxyXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn1cclxuICAgICAqL1xyXG4gICAgaXNJbldvcmtUaW1lKG5ld0hvdXJWYWx1ZSkge1xyXG4gICAgICAgIGxldCBtb3JuaW5nSG91cnMgPSB0aGlzLnJlcGV0aXRpb24uaG91cnNJbkFEYXkubW9ybmluZ1xyXG4gICAgICAgIGxldCBhZnRlcm5vb25Ib3VycyA9IHRoaXMucmVwZXRpdGlvbi5ob3Vyc0luQURheS5hZnRlcm5vb25cclxuXHJcbiAgICAgICAgcmV0dXJuIChuZXdIb3VyVmFsdWUgPiBtb3JuaW5nSG91cnNbMF0gXHJcbiAgICAgICAgICAgICYmIG5ld0hvdXJWYWx1ZSA8IG1vcm5pbmdIb3Vyc1sxXSlcclxuICAgICAgICAgICAgfHwgKG5ld0hvdXJWYWx1ZSA+IGFmdGVybm9vbkhvdXJzWzBdIFxyXG4gICAgICAgICAgICAmJiBuZXdIb3VyVmFsdWUgPCBhZnRlcm5vb25Ib3Vyc1sxXSlcclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlcGV0aXRpb25EYXRlIGV4dGVuZHMgRGF0ZSB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoeWVhcilcclxuICAgIHtcclxuICAgICAgICBzdXBlcigpXHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5udW1iZXJPZkRheXNQZXJNb250aCA9IHtcclxuICAgICAgICAgICAgMTogMzEsXHJcbiAgICAgICAgICAgIDI6IDI4LFxyXG4gICAgICAgICAgICAzOiAzMSxcclxuICAgICAgICAgICAgNDogMzAsXHJcbiAgICAgICAgICAgIDU6IDMxLFxyXG4gICAgICAgICAgICA2OiAzMCxcclxuICAgICAgICAgICAgNzogMzEsXHJcbiAgICAgICAgICAgIDg6IDMxLFxyXG4gICAgICAgICAgICA5OiAzMCxcclxuICAgICAgICAgICAgMTA6IDMxLFxyXG4gICAgICAgICAgICAxMTogMzAsXHJcbiAgICAgICAgICAgIDEyOiAzMVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsIlxyXG5leHBvcnQgY2xhc3MgbW9kYWxSZXNpemUge1xyXG4gICAgXHJcbiAgICBjb25zdHJ1Y3RvcihDYWxlbmRhckNyZWF0aW9uRE9NKSBcclxuICAgIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAdHlwZSBDYWxlbmRhckNyZWF0aW9uRE9NSW50ZXJhY3Rpb25zXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5jYWxlbmRhckNyZWF0aW9uRE9NID0gQ2FsZW5kYXJDcmVhdGlvbkRPTVxyXG4gICAgICAgIHRoaXMuaXNSb3dBY3Rpb25CdXR0b25zSGlkZGVuID0gZmFsc2VcclxuICAgICAgICB0aGlzLmhhbmRsZVdpbmRvd1Jlc2l6ZSgpXHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMuaGFuZGxlV2luZG93UmVzaXplLmJpbmQodGhpcykpXHJcbiAgICB9XHJcblxyXG4gICAgaGFuZGxlV2luZG93UmVzaXplKClcclxuICAgIHtcclxuICAgICAgICBsZXQgaGlkZVJvd0FjdGlvbkJ1dHRvbnMgPSB3aW5kb3cuaW5uZXJXaWR0aCA8PSA4MDBcclxuICAgICAgICBpZihoaWRlUm93QWN0aW9uQnV0dG9ucyAmJiB0aGlzLmNhbGVuZGFyQ3JlYXRpb25ET00ubW9kYWwpe1xyXG4gICAgICAgICAgICB0aGlzLmlzUm93QWN0aW9uQnV0dG9uc0hpZGRlbiA9IHRydWVcclxuICAgICAgICAgICAgdGhpcy5jYWxlbmRhckNyZWF0aW9uRE9NLmFwcGVuZFJvd0FjdGlvbkJ1dHRvbnNJbnRvQU1lbnUoKVxyXG4gICAgICAgIH1lbHNlIGlmKCFoaWRlUm93QWN0aW9uQnV0dG9ucyAmJiB0aGlzLmNhbGVuZGFyQ3JlYXRpb25ET00ubW9kYWwgJiYgdGhpcy5pc1Jvd0FjdGlvbkJ1dHRvbnNIaWRkZW4pIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxlbmRhckNyZWF0aW9uRE9NLmdldFJvd0FjdGlvbkJ1dHRvbnNPdXRPZk1lbnUoKVxyXG4gICAgICAgICAgICB0aGlzLmlzUm93QWN0aW9uQnV0dG9uc0hpZGRlbiA9IGZhbHNlXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgSXNJdGVyYWJsZSwgY2xhc3NpY0Zvckxvb3AsIGNyZWF0ZUFycmF5LCBmb3JlYWNoQXJyYXlFbGVtZW50cywgaXNVbmRlZmluZWQsIGxvb3BPdmVyT2JqZWN0LCBwdXNoRWxlbWVudFRvQXJyYXkgfSBmcm9tIFwiLi4vLi4vRnVuY3Rpb25zL1Rvb2xzL1Rvb2xzXCJcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGNhbGVuZGFyR2VuZXJhdGlvblRvb2xzIHtcclxuICAgIC8qKlxyXG4gICAgICogXHJcbiAgICAgKiBAcGFyYW0ge2NhbGVuZGFyR2VuZXJhdGlvbn0gY2FsZW5kYXJHZW5lcmF0aW9uIFxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcigpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5tb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYWxlbmRhcl9jcmVhdGlvbl9tb2RhbCcpXHJcbiAgICAgICAgdGhpcy5kYXRlVHlwZUlucHV0cyA9IFtdXHJcbiAgICAgICAgdGhpcy5pbnB1dHNXaXRoU2FtZURhdGUgPSB7fVxyXG4gICAgICAgIHRoaXMuaW5wdXRzV2l0aFBsdXNWYWx1ZVRvQWRkID0gW11cclxuICAgICAgICB0aGlzLmN1cnJlbnREYXRlVHlwZUlucHV0XHJcbiAgICAgICAgdGhpcy5saW5lc1RvUmVwZWF0ID0ge31cclxuICAgICAgICB0aGlzLmxpbmVzT2ZJbnB1dHNXaXRoU2FtZURhdGUgPSB7fVxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEB0eXBlIHt7W2tleTogc3RyaW5nXTogSFRNTFRhYmxlUm93RWxlbWVudFtdfSB8IHVuZGVmaW5lZH1cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmN1cnJlbnRPYmpUb0xvb3BGb3JTcGFjaW5nXHJcbiAgICAgICAgdGhpcy5uZXh0RGF0ZVR5cGVJbnB1dFxyXG4gICAgICAgIHRoaXMubnVtYmVyT2ZMaW5lc09mRXhlcmNpc2UgPSAwXHJcbiAgICAgICAgdGhpcy5udW1iZXJPZkxpbmVzT2ZFeGVyY2lzZVBlckRhdGUgPSBbXVxyXG4gICAgICAgIHRoaXMuc3BhY2VJc1VuZGVyMkggPSBmYWxzZVxyXG4gICAgfVxyXG5cclxuICAgIGZpbGxJbnB1dHNXaXRoU2FtZURhdGUoKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuaW5wdXRzID0gY3JlYXRlQXJyYXkodGhpcy5tb2RhbC5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCcpKVxyXG4gICAgICAgIHRoaXMuZmlsbERhdGVUeXBlSW5wdXRzKClcclxuICAgICAgICB0aGlzLmZpbGxJbnB1dHNXaXRoU2FtZUJ5RGF0ZVR5cGVJbnB1dHMoKVxyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGZpbGxEYXRlVHlwZUlucHV0cygpXHJcbiAgICB7XHJcbiAgICAgICAgZm9yZWFjaEFycmF5RWxlbWVudHModGhpcy5pbnB1dHMsIChpbnB1dCkgPT4ge1xyXG4gICAgICAgICAgICBpZihpbnB1dC5pZCA9PT0gJ2RhdGUtaW5wdXQnKSB7XHJcbiAgICAgICAgICAgICAgICBwdXNoRWxlbWVudFRvQXJyYXkoaW5wdXQsIHRoaXMuZGF0ZVR5cGVJbnB1dHMpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGZpbGxJbnB1dHNXaXRoU2FtZUJ5RGF0ZVR5cGVJbnB1dHMoKVxyXG4gICAge1xyXG4gICAgICAgIGNsYXNzaWNGb3JMb29wKHRoaXMuZGF0ZVR5cGVJbnB1dHMsIChjdXJyZW50RGF0ZVR5cGVJbnB1dCwgbmV4dERhdGVUeXBlSW5wdXQpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50RGF0ZVR5cGVJbnB1dCA9IGN1cnJlbnREYXRlVHlwZUlucHV0XHJcbiAgICAgICAgICAgIHRoaXMubmV4dERhdGVUeXBlSW5wdXQgPSBuZXh0RGF0ZVR5cGVJbnB1dFxyXG4gICAgICAgICAgICBpZighaXNVbmRlZmluZWQobmV4dERhdGVUeXBlSW5wdXQpKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRGF0ZUluQ3VycmVudEFuZE5leHREYXRlVHlwZUlucHV0c0FyZVNhbWUoKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVEYXRlSW5DdXJyZW50QW5kTmV4dERhdGVUeXBlSW5wdXRzQXJlRGlmZmVyZW50cygpXHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wdXNoQ3VycmVudERhdGVUeXBlSW5wdXQoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBoYW5kbGVEYXRlSW5DdXJyZW50QW5kTmV4dERhdGVUeXBlSW5wdXRzQXJlU2FtZSgpXHJcbiAgICB7XHJcbiAgICAgICAgY29uc3QgZGF0ZUluQ3VycmVudElucHV0ID0gdGhpcy5jdXJyZW50RGF0ZVR5cGVJbnB1dC52YWx1ZVxyXG4gICAgICAgIGNvbnN0IGRhdGVJbk5leHRJbnB1dCA9IHRoaXMubmV4dERhdGVUeXBlSW5wdXQudmFsdWVcclxuICAgICAgICBpZihkYXRlSW5DdXJyZW50SW5wdXQgPT09IGRhdGVJbk5leHRJbnB1dCl7XHJcbiAgICAgICAgICAgdGhpcy5wdXNoQ3VycmVudEFuZE5leHREYXRlVHlwZUlucHV0SW5TYW1lQXJyYXkoZGF0ZUluQ3VycmVudElucHV0KSAgIFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdXNoQ3VycmVudEFuZE5leHREYXRlVHlwZUlucHV0SW5TYW1lQXJyYXkoZGF0ZSlcclxuICAgIHtcclxuICAgICAgICBpZihpc1VuZGVmaW5lZCh0aGlzLmlucHV0c1dpdGhTYW1lRGF0ZVtkYXRlXSkpe1xyXG4gICAgICAgICAgICB0aGlzLmlucHV0c1dpdGhTYW1lRGF0ZVtkYXRlXSA9IFtdXHJcbiAgICAgICAgICAgIHRoaXMuaW5wdXRzV2l0aFNhbWVEYXRlW2RhdGVdLnB1c2godGhpcy5jdXJyZW50RGF0ZVR5cGVJbnB1dClcclxuICAgICAgICAgICAgdGhpcy5pbnB1dHNXaXRoU2FtZURhdGVbZGF0ZV0ucHVzaCh0aGlzLm5leHREYXRlVHlwZUlucHV0KVxyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aGlzLmlucHV0c1dpdGhTYW1lRGF0ZVtkYXRlXS5wdXNoKHRoaXMubmV4dERhdGVUeXBlSW5wdXQpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGhhbmRsZURhdGVJbkN1cnJlbnRBbmROZXh0RGF0ZVR5cGVJbnB1dHNBcmVEaWZmZXJlbnRzKClcclxuICAgIHtcclxuICAgICAgICBjb25zdCBkYXRlSW5DdXJyZW50SW5wdXQgPSB0aGlzLmN1cnJlbnREYXRlVHlwZUlucHV0LnZhbHVlXHJcbiAgICAgICAgY29uc3QgZGF0ZUluTmV4dElucHV0ID0gdGhpcy5uZXh0RGF0ZVR5cGVJbnB1dC52YWx1ZVxyXG4gICAgICAgIGlmKGRhdGVJbkN1cnJlbnRJbnB1dCAhPT0gZGF0ZUluTmV4dElucHV0KXtcclxuICAgICAgICAgICAgdGhpcy5wdXNoQ3VycmVudEFuZE5leHREYXRlVHlwZUlucHV0SW5EaWZmZXJlbnRBcnJheXMoZGF0ZUluQ3VycmVudElucHV0LCBkYXRlSW5OZXh0SW5wdXQpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1c2hDdXJyZW50QW5kTmV4dERhdGVUeXBlSW5wdXRJbkRpZmZlcmVudEFycmF5cyhkYXRlSW5DdXJyZW50SW5wdXQsIGRhdGVJbk5leHRJbnB1dClcclxuICAgIHtcclxuICAgICAgICBpZihpc1VuZGVmaW5lZCh0aGlzLmlucHV0c1dpdGhTYW1lRGF0ZVtkYXRlSW5DdXJyZW50SW5wdXRdKSl7XHJcbiAgICAgICAgICAgIHRoaXMuaW5wdXRzV2l0aFNhbWVEYXRlW2RhdGVJbkN1cnJlbnRJbnB1dF0gPSBbXVxyXG4gICAgICAgICAgICB0aGlzLmlucHV0c1dpdGhTYW1lRGF0ZVtkYXRlSW5DdXJyZW50SW5wdXRdLnB1c2godGhpcy5jdXJyZW50RGF0ZVR5cGVJbnB1dClcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgaWYoaXNVbmRlZmluZWQodGhpcy5pbnB1dHNXaXRoU2FtZURhdGVbZGF0ZUluTmV4dElucHV0XSkpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbnB1dHNXaXRoU2FtZURhdGVbZGF0ZUluTmV4dElucHV0XSA9IFtdXHJcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0c1dpdGhTYW1lRGF0ZVtkYXRlSW5OZXh0SW5wdXRdLnB1c2godGhpcy5uZXh0RGF0ZVR5cGVJbnB1dClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdXNoQ3VycmVudERhdGVUeXBlSW5wdXQoKVxyXG4gICAge1xyXG4gICAgICAgIGNvbnN0IGRhdGVJbkN1cnJlbnRJbnB1dCA9IHRoaXMuY3VycmVudERhdGVUeXBlSW5wdXQudmFsdWVcclxuICAgICAgICBpZihpc1VuZGVmaW5lZCh0aGlzLmlucHV0c1dpdGhTYW1lRGF0ZVtkYXRlSW5DdXJyZW50SW5wdXRdKSl7XHJcbiAgICAgICAgICAgIHRoaXMuaW5wdXRzV2l0aFNhbWVEYXRlW2RhdGVJbkN1cnJlbnRJbnB1dF0gPSBbXVxyXG4gICAgICAgICAgICB0aGlzLmlucHV0c1dpdGhTYW1lRGF0ZVtkYXRlSW5DdXJyZW50SW5wdXRdLnB1c2godGhpcy5jdXJyZW50RGF0ZVR5cGVJbnB1dClcclxuICAgICAgICB9ICBcclxuICAgIH1cclxuXHJcbiAgICBmZXRjaExpbmVzVG9SZXBlYXQoKVxyXG4gICAge1xyXG4gICAgICAgIGxvb3BPdmVyT2JqZWN0KHRoaXMuaW5wdXRzV2l0aFNhbWVEYXRlLCAoZGF0ZSwgaW5wdXRzKT0+e1xyXG4gICAgICAgICAgICBmb3JlYWNoQXJyYXlFbGVtZW50cyhpbnB1dHMsIChpbnB1dCk9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnB1c2hJbnRvTGluZXNUb1JlcGVhdExpbmVzV2ljaEFyZU5vdEV4ZXJjaXNlKGlucHV0LCBkYXRlKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgcHVzaEludG9MaW5lc1RvUmVwZWF0TGluZXNXaWNoQXJlTm90RXhlcmNpc2UoaW5wdXQsIGRhdGUpXHJcbiAgICB7XHJcbiAgICAgICAgbGV0IGlucHV0TGluZSA9IGlucHV0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudFxyXG4gICAgICAgIGxldCBpbnB1dFR5cGVDaGFwdGVyID0gaW5wdXRMaW5lLnF1ZXJ5U2VsZWN0b3IoJyNjaGFwdGVyLWlucHV0JylcclxuICAgICAgICBjb25zdCBpbnB1dFZhbHVlID0gaW5wdXRUeXBlQ2hhcHRlci52YWx1ZVxyXG4gICAgICAgIGlmKGlucHV0VmFsdWUuaW5jbHVkZXMoXCJleGVyY2ljZVwiKSl7XHJcbiAgICAgICAgICAgIHRoaXMubnVtYmVyT2ZMaW5lc09mRXhlcmNpc2UrK1xyXG4gICAgICAgICAgICB0aGlzLm51bWJlck9mTGluZXNPZkV4ZXJjaXNlUGVyRGF0ZVtkYXRlXSA9IHRoaXMubnVtYmVyT2ZMaW5lc09mRXhlcmNpc2VcclxuICAgICAgICB9ZWxzZSB7XHJcbiAgICAgICAgICAgIGlmKGlzVW5kZWZpbmVkKHRoaXMubGluZXNUb1JlcGVhdFtkYXRlXSkpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saW5lc1RvUmVwZWF0W2RhdGVdID0gW11cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmxpbmVzVG9SZXBlYXRbZGF0ZV0ucHVzaChpbnB1dFR5cGVDaGFwdGVyLnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudClcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGZldGNoUm93c1dpdGhTYW1lRGF0ZSgpXHJcbiAgICB7XHJcbiAgICAgICAgbGV0IHRhYmxlTGluZXMgPSBjcmVhdGVBcnJheSh0aGlzLm1vZGFsLnF1ZXJ5U2VsZWN0b3IoJ3Rib2R5JykucXVlcnlTZWxlY3RvckFsbCgndHInKSlcclxuICAgICAgICB0YWJsZUxpbmVzLmZvckVhY2gobGluZSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGUgPSBsaW5lLnF1ZXJ5U2VsZWN0b3IoJyNkYXRlLWlucHV0JykudmFsdWVcclxuICAgICAgICAgICAgY29uc3QgaG91ciA9IGxpbmUucXVlcnlTZWxlY3RvcignI2hvdXItaW5wdXQnKS52YWx1ZVxyXG5cclxuICAgICAgICAgICAgaWYoaXNVbmRlZmluZWQodGhpcy5saW5lc09mSW5wdXRzV2l0aFNhbWVEYXRlW2RhdGVdKSl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpbmVzT2ZJbnB1dHNXaXRoU2FtZURhdGVbZGF0ZV0gPSBbXVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLmxpbmVzT2ZJbnB1dHNXaXRoU2FtZURhdGVbZGF0ZV0ucHVzaChsaW5lKVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgc3BhY2VFdmVyeVJldmlzaW9uc1NwYWNlZFVuZGVyMkgoKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuY291bnREYXRlID0gMFxyXG4gICAgICAgIHRoaXMubGFzdENvdW50RGF0ZSA9IDBcclxuICAgICAgICBcclxuICAgICAgICBmb3IoY29uc3QgZGF0ZSBpbiB0aGlzLmxpbmVzT2ZJbnB1dHNXaXRoU2FtZURhdGUpe1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRSb3dzT2ZBRGF0ZSA9IHRoaXMubGluZXNPZklucHV0c1dpdGhTYW1lRGF0ZVtkYXRlXVxyXG4gICAgICAgICAgICB0aGlzLmNvdW50RGF0ZSsrXHJcbiAgICAgICAgICAgIGlmKElzSXRlcmFibGUodGhpcy5jdXJyZW50Um93c09mQURhdGUpKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29tcGFyYXRlVGltZVZhbHVlc0luRWFjaFJvdygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5sYXN0Q291bnREYXRlID0gdGhpcy5jb3VudERhdGVcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgXHJcbiAgICBjb21wYXJhdGVUaW1lVmFsdWVzSW5FYWNoUm93KClcclxuICAgIHtcclxuICAgICAgICBpZighaXNVbmRlZmluZWQodGhpcy5jdXJyZW50Um93c09mQURhdGUpKXtcclxuICAgICAgICAgICAgdGhpcy50YWtlRWFjaFJvd0FuZENvbXBhcmF0ZVdpdGhPdGhlclJvd3MoKVxyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJMYSBwcm9wcmnDqXTDqSB0aGlzLmN1cnJlbnRSb3dXaXRoU2FtZURhdGUgZXN0IHVuZGVmaW5lZFwiKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0YWtlRWFjaFJvd0FuZENvbXBhcmF0ZVdpdGhPdGhlclJvd3MoKVxyXG4gICAge1xyXG4gICAgICAgIGlmKGlzVW5kZWZpbmVkKHRoaXMuY291bnREYXRlKSB8fCBpc1VuZGVmaW5lZCh0aGlzLmxhc3RDb3VudERhdGUpKXtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTGVzIHByb3ByacOpdMOpcyB0aGlzLmNvdW50RGF0ZSBldCB0aGlzLmxhc3RDb3VudERhdGUgbmUgcGV1dmVudCBwYXMgw6p0cmUgdW5kZWZpbmVkLlwiKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5jdXJyZW50Um93c09mQURhdGU/LmZvckVhY2gocm93ID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50SG91cklucHV0ID0gcm93LnF1ZXJ5U2VsZWN0b3IoJyNob3VyLWlucHV0JylcclxuICAgICAgICAgICAgdGhpcy5tYWtlQ29tcGFyaXNvblBlckRhdGUocm93KSBcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRmFpdCBlbiBzb3J0ZSBxdWUgbGEgY29tcGFyYWlzb24gbmUgc2UgZmFzc2UgcXVlIGRhbnMgbGVzIGxpZ25lcyBkZSBtw6ptZSBkYXRlLlxyXG4gICAgICogRmFpdCBsYSBjb21wYXJhaXNvbiBkZXMgaGV1cmVzIMOgIGwnaW50w6lyaWV1ciBkZSBsJ2lucHV0IHR5cGU9aG91ciBkZXMgbGlnbmVzIGRlIG3Dqm1lIGRhdGUuIFxyXG4gICAgICogQHBhcmFtIHtIVE1MVGFibGVSb3dFbGVtZW50fSByb3dcclxuICAgICAqL1xyXG4gICAgbWFrZUNvbXBhcmlzb25QZXJEYXRlKHJvdylcclxuICAgIHtcclxuICAgICAgICBpZih0aGlzLmN1cnJlbnRSb3dJc09uZVN0ZXBBd2F5RnJvbVRoZVByZWNlZGVudCgpKXtcclxuICAgICAgICAgICAgdGhpcy5jb21wYXJhdGVDdXJyZW50V2l0aERpZmZlcmVudE9uZShyb3cpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gbGEgbGlnbmUgY291cnJhbnRlIHN1aXQgZGlyZWN0ZW1lbnQgbGEgcHLDqWPDqWRlbnRlLiBJbCBuJ3kgYSBwYXMgZGUgc2F1dCBvdSBhdXRyZXNcclxuICAgICAqL1xyXG4gICAgY3VycmVudFJvd0lzT25lU3RlcEF3YXlGcm9tVGhlUHJlY2VkZW50KClcclxuICAgIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb3VudERhdGUgPT09IHRoaXMubGFzdENvdW50RGF0ZSArIDFcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFxyXG4gICAgICogQHBhcmFtIHtIVE1MVGFibGVSb3dFbGVtZW50fSByb3cgXHJcbiAgICAgKi9cclxuICAgIGNvbXBhcmF0ZUN1cnJlbnRXaXRoRGlmZmVyZW50T25lKHJvdylcclxuICAgIHtcclxuICAgICAgICB0aGlzLnNwbGl0dGVkSG91clZhbHVlT2ZDdXJyZW50SW5wdXQgPSB0aGlzLmN1cnJlbnRIb3VySW5wdXQ/LnZhbHVlLnNwbGl0KCc6JylcclxuXHJcbiAgICAgICAgdGhpcy5jdXJyZW50Um93c09mQURhdGUuZm9yRWFjaChwYXJhbGxlbFJvdyA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyb3cgIT09IHBhcmFsbGVsUm93KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmFsbGVsUm93SG91cklucHV0ID0gcGFyYWxsZWxSb3cucXVlcnlTZWxlY3RvcignI2hvdXItaW5wdXQnKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5zcGxpdHRlZFBhcmFsbGVsUm93SG91cklucHV0VmFsdWUgPSB0aGlzLnBhcmFsbGVsUm93SG91cklucHV0LnZhbHVlLnNwbGl0KCc6JylcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50Um93SG91clZhbHVlID0gdGhpcy5zcGxpdHRlZEhvdXJWYWx1ZU9mQ3VycmVudElucHV0WzBdXHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRSb3dNaW51dGVzVmFsdWUgPSB0aGlzLnNwbGl0dGVkSG91clZhbHVlT2ZDdXJyZW50SW5wdXRbMV1cclxuICAgICAgICAgICAgICAgIHRoaXMucGFyYWxsZWxSb3dIb3VyVmFsdWUgPSB0aGlzLnNwbGl0dGVkUGFyYWxsZWxSb3dIb3VySW5wdXRWYWx1ZVswXVxyXG4gICAgICAgICAgICAgICAgdGhpcy5wYXJhbGxlbFJvd01pbnV0ZXNWYWx1ZSA9IHRoaXMuc3BsaXR0ZWRQYXJhbGxlbFJvd0hvdXJJbnB1dFZhbHVlWzFdXHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50QW5kTGFzdElucHV0c0hvdXJzRGlmZiA9IHBhcnNlSW50KHRoaXMuY3VycmVudFJvd0hvdXJWYWx1ZSkgLVxyXG4gICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KHRoaXMucGFyYWxsZWxSb3dIb3VyVmFsdWUpXHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRBbmRMYXN0SW5wdXRzTWludXRlc0RpZmYgPSBwYXJzZUludCh0aGlzLmN1cnJlbnRSb3dNaW51dGVzVmFsdWUpIC1cclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludCh0aGlzLnBhcmFsbGVsUm93TWludXRlc1ZhbHVlKVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yZXZpc2lvbnNBcmVTcGFjZWRVbmRlcjJIKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNwYWNlSXNVbmRlcjJIID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubW9kaWZ5SG91cigpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHJldHVybnMgYm9vbGVhblxyXG4gICAgICogQHRocm93cyB7RXJyb3J9IHNpIGxhIHZhcmlhYmxlIHRoaXMuY3VycmVudEFuZExhc3RJbnB1dHNIb3Vyc0RpZmYgbidlc3QgcGFzIGTDqWZpbmllXHJcbiAgICAgKiBhdmFudCBsJ2FwcGVsIGRlIGxhIGZvbmN0aW9uXHJcbiAgICAgKi9cclxuICAgIHJldmlzaW9uc0FyZVNwYWNlZFVuZGVyMkgoKSB7XHJcbiAgICAgICAgaWYoIWlzVW5kZWZpbmVkKHRoaXMuY3VycmVudEFuZExhc3RJbnB1dHNIb3Vyc0RpZmYpKXtcclxuICAgICAgICAgICAgcmV0dXJuIE1hdGguYWJzKHRoaXMuY3VycmVudEFuZExhc3RJbnB1dHNIb3Vyc0RpZmYpIDwgMiB8fCB0aGlzLmZld01pbnV0ZXNNaXNzZWRUb0NvbXBsZXRlMkgoKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTGEgdmFyaWFibGUgdGhpcy5jdXJyZW50QW5kTGFzdElucHV0c0hvdXJzRGlmZiB1bmRlZmluZWRcIilcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFxyXG4gICAgICogQHJldHVybnMgYm9vbGVhblxyXG4gICAgICogQHRocm93cyB7RXJyb3J9IHNpIGxlcyB2YXJpYWJsZXMgdGhpcy5jdXJyZW50QW5kTGFzdElucHV0c01pbnV0ZXNEaWZmIFxyXG4gICAgICogZXQgdGhpcy5jdXJyZW50QW5kTGFzdElucHV0c0hvdXJzRGlmZiBuZSBzb250IHBhcyBkw6lmaW5pZXMgXHJcbiAgICAgKiBhdmFudCBsJ2FwcGVsIGRlIGxhIGZvbmN0aW9uXHJcbiAgICAgKi9cclxuICAgIGZld01pbnV0ZXNNaXNzZWRUb0NvbXBsZXRlMkgoKVxyXG4gICAge1xyXG4gICAgICAgIGlmKCFpc1VuZGVmaW5lZCh0aGlzLmN1cnJlbnRBbmRMYXN0SW5wdXRzSG91cnNEaWZmKVxyXG4gICAgICAgICAgICAmJiAhaXNVbmRlZmluZWQodGhpcy5jdXJyZW50QW5kTGFzdElucHV0c01pbnV0ZXNEaWZmKVxyXG4gICAgICAgICl7XHJcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5jdXJyZW50QW5kTGFzdElucHV0c0hvdXJzRGlmZiA8IDAgXHJcbiAgICAgICAgICAgICAgICAmJiBNYXRoLmFicyh0aGlzLmN1cnJlbnRBbmRMYXN0SW5wdXRzSG91cnNEaWZmKSA9PT0gMiAmJlxyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50QW5kTGFzdElucHV0c01pbnV0ZXNEaWZmID4gMCkgfHwgKHRoaXMuY3VycmVudEFuZExhc3RJbnB1dHNIb3Vyc0RpZmYgPiAwIFxyXG4gICAgICAgICAgICAgICAgJiYgTWF0aC5hYnModGhpcy5jdXJyZW50QW5kTGFzdElucHV0c0hvdXJzRGlmZikgPT09IDIgJiZcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEFuZExhc3RJbnB1dHNNaW51dGVzRGlmZiA8IDApXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJMZXMgdmFyaWFibGVzIHRoaXMuY3VycmVudEFuZExhc3RJbnB1dHNIb3Vyc0RpZmYgZXQgdGhpcy5jdXJyZW50QW5kTGFzdElucHV0c01pbnV0ZXNEaWZmIHNvbnQgdW5kZWZpbmVkXCIpXHJcbiAgICB9XHJcblxyXG4gICAgbW9kaWZ5SG91cigpXHJcbiAgICB7XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgIWlzVW5kZWZpbmVkKHRoaXMuY3VycmVudEFuZExhc3RJbnB1dHNIb3Vyc0RpZmYpICYmXHJcbiAgICAgICAgICAhaXNVbmRlZmluZWQodGhpcy5jdXJyZW50QW5kTGFzdElucHV0c01pbnV0ZXNEaWZmKVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50Um93SG91clZhbHVlSXNTdXBlcmlvcigpKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5BZGROZXdIb3VyVmFsdWUodGhpcy5jdXJyZW50SG91cklucHV0LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgaG91cjogcGFyc2VJbnQodGhpcy5jdXJyZW50Um93SG91clZhbHVlKSArIDEsIFxyXG4gICAgICAgICAgICAgICAgICAgIG1pbnV0ZXM6IHRoaXMucGFyYWxsZWxSb3dNaW51dGVzVmFsdWUubGVuZ3RoID09PSAxXHJcbiAgICAgICAgICAgICAgICAgICAgPyBcIjBcIiArIHRoaXMucGFyYWxsZWxSb3dNaW51dGVzVmFsdWVcclxuICAgICAgICAgICAgICAgICAgICA6IHRoaXMucGFyYWxsZWxSb3dNaW51dGVzVmFsdWVcclxuICAgICAgICAgICAgICAgIH0pIFxyXG5cclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmJvdGhIb3Vyc1ZhbHVlc0FyZUVxdWFscygpKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudEFuZExhc3RJbnB1dHNNaW51dGVzRGlmZiA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLkFkZE5ld0hvdXJWYWx1ZSh0aGlzLmN1cnJlbnRIb3VySW5wdXQsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaG91cjogcGFyc2VJbnQodGhpcy5jdXJyZW50Um93SG91clZhbHVlKSArIDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pbnV0ZXM6IHRoaXMucGFyYWxsZWxSb3dNaW51dGVzVmFsdWUubGVuZ3RoID09PSAxXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gXCIwXCIgKyB0aGlzLnBhcmFsbGVsUm93TWludXRlc1ZhbHVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogdGhpcy5wYXJhbGxlbFJvd01pbnV0ZXNWYWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuY3VycmVudEFuZExhc3RJbnB1dHNNaW51dGVzRGlmZiA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuQWRkTmV3SG91clZhbHVlKHRoaXMucGFyYWxsZWxSb3dIb3VySW5wdXQsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaG91cjogcGFyc2VJbnQodGhpcy5jdXJyZW50Um93SG91clZhbHVlKSArIDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pbnV0ZXM6IHRoaXMucGFyYWxsZWxSb3dNaW51dGVzVmFsdWUubGVuZ3RoID09PSAxXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gXCIwXCIgKyB0aGlzLnBhcmFsbGVsUm93TWludXRlc1ZhbHVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogdGhpcy5wYXJhbGxlbFJvd01pbnV0ZXNWYWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuQWRkTmV3SG91clZhbHVlKHRoaXMucGFyYWxsZWxSb3dIb3VySW5wdXQsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaG91cjogcGFyc2VJbnQodGhpcy5wYXJhbGxlbFJvd0hvdXJWYWx1ZSkgKyAyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtaW51dGVzOiB0aGlzLmN1cnJlbnRSb3dNaW51dGVzVmFsdWUubGVuZ3RoID09PSAxXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gXCIwXCIgKyB0aGlzLmN1cnJlbnRSb3dNaW51dGVzVmFsdWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiB0aGlzLmN1cnJlbnRSb3dNaW51dGVzVmFsdWVcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5BZGROZXdIb3VyVmFsdWUodGhpcy5wYXJhbGxlbFJvd0hvdXJJbnB1dCwge1xyXG4gICAgICAgICAgICAgICAgICAgIGhvdXI6IHBhcnNlSW50KHRoaXMucGFyYWxsZWxSb3dIb3VyVmFsdWUpICsgMSxcclxuICAgICAgICAgICAgICAgICAgICBtaW51dGVzOiB0aGlzLmN1cnJlbnRSb3dNaW51dGVzVmFsdWUubGVuZ3RoID09PSAxXHJcbiAgICAgICAgICAgICAgICAgICAgPyBcIjBcIiArIHRoaXMuY3VycmVudFJvd01pbnV0ZXNWYWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgIDogdGhpcy5jdXJyZW50Um93TWludXRlc1ZhbHVlXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJMZXMgcHJvcHJpw6l0w6lzIHRoaXMuY3VycmVudEFuZExhc3RJbnB1dHNIb3Vyc0RpZmYgZXQgdGhpcy5jdXJyZW50QW5kTGFzdElucHV0c01pbnV0ZXNEaWZmIHNvbnQgdW5kZWZpbmVkXCIpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogXHJcbiAgICAgKiBAcGFyYW0ge0hUTUxUYWJsZVJvd0VsZW1lbnR9IGhvdXJJbnB1dCBcclxuICAgICAqIEBwYXJhbSB7e2hvdXI6IG51bWJlciwgbWludXRlczogbnVtYmVyfX0gdGltZSBcclxuICAgICAqL1xyXG4gICAgQWRkTmV3SG91clZhbHVlKGhvdXJJbnB1dCwgdGltZSlcclxuICAgIHtcclxuICAgICAgICBob3VySW5wdXQudmFsdWUgPSB0aW1lLmhvdXIudG9TdHJpbmcoKS5sZW5ndGggPiAxXHJcbiAgICAgICAgICAgICAgICA/IHRpbWUuaG91ci50b1N0cmluZygpICsgXCI6XCIgKyB0aW1lLm1pbnV0ZXNcclxuICAgICAgICAgICAgICAgIDogXCIwXCIgKyB0aW1lLmhvdXIudG9TdHJpbmcoKSArIFwiOlwiICsgdGltZS5taW51dGVzO1xyXG4gICAgfVxyXG5cclxuICAgIGN1cnJlbnRSb3dIb3VyVmFsdWVJc1N1cGVyaW9yKClcclxuICAgIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50QW5kTGFzdElucHV0c0hvdXJzRGlmZiA+IDBcclxuICAgIH1cclxuXHJcbiAgICBib3RoSG91cnNWYWx1ZXNBcmVFcXVhbHMoKVxyXG4gICAge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRBbmRMYXN0SW5wdXRzSG91cnNEaWZmID09PSAwXHJcbiAgICB9XHJcblxyXG4gICAgcHVzaFJlbW92ZUJ1dHRvbklmSW5Sb3dBY3Rpb25CdXR0b25zVG9BcnJheShyb3dBY3Rpb25CdXR0b25zLCBhcnJheSlcclxuICAgIHtcclxuICAgICAgICBpZihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucmVtb3ZlX2xpbmVfYnV0dG9uJykgaW4gcm93QWN0aW9uQnV0dG9ucykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnb2sgaXRcXCdzIGluJylcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBwb3N0IH0gZnJvbSBcIi4uL0Z1bmN0aW9ucy9SZXF1ZXN0L2FqYXhcIjtcclxuaW1wb3J0IHsgZWxlbWVudEhhc0NsYXNzTmFtZSwgcmVtb3ZlRWxlbWVudEZyb21ET00gfSBmcm9tIFwiLi4vRnVuY3Rpb25zL1Rvb2xzL0RPTVRvb2xzXCI7XHJcbmltcG9ydCB7IGNyZWF0ZUFycmF5LCBmb3JlYWNoQXJyYXlFbGVtZW50cywgaXNVbmRlZmluZWQsIGxvb3BPdmVyT2JqZWN0IH0gZnJvbSBcIi4uL0Z1bmN0aW9ucy9Ub29scy9Ub29sc1wiO1xyXG5pbXBvcnQgUmVwZXRpdGlvbiBmcm9tIFwiLi4vUmVwZXRpdGlvbnNHZW5lcmF0aW9uL1JlcGV0aXRpb25cIjtcclxuaW1wb3J0IFJlcGV0aXRpb25EYXRlIGZyb20gXCIuLi9SZXBldGl0aW9uc0dlbmVyYXRpb24vUmVwZXRpdGlvbkRhdGVcIjtcclxuaW1wb3J0IHsgbW9kYWxSZXNpemUgfSBmcm9tIFwiLi4vcmVzcG9uc2l2ZXMvbW9kYWxSZXNpemVcIjtcclxuaW1wb3J0IERPTUludGVyYWN0aW9ucyBmcm9tIFwiLi9ET01JbnRlcmFjdGlvbnNcIjtcclxuaW1wb3J0IGNhbGVuZGFyR2VuZXJhdGlvblRvb2xzIGZyb20gXCIuL1Rvb2xzL2NhbGVuZGFyR2VuZXJhdGlvblRvb2xzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYWxlbmRhckNyZWF0aW9uRE9NSW50ZXJhY3Rpb25zIGV4dGVuZHMgRE9NSW50ZXJhY3Rpb25zIHtcclxuICAgIGZvcm1BY3Rpb24gPSAnL2NyZWF0ZS1jYWxlbmRhcidcclxuICAgIG5vdGlmaWNhdGlvbkNsYXNzTmFtZSA9ICdjYWxlbmRhcl9jcmVhdGlvbl9ub3RpZmljYXRpb24nXHJcblxyXG4gICAgY29uc3RydWN0b3IoKVxyXG4gICAge1xyXG4gICAgICAgIHN1cGVyKClcclxuICAgICAgICB0aGlzLmFjdGlvbnNCdXR0b25zUGVyUm93ID0ge31cclxuICAgICAgICB0aGlzLmF0TGVhc3RPbmVSb3dJc0V4ZXJjaXNlID0gNFxyXG4gICAgICAgIHRoaXMuYXRMZWFzdFR3b1Jvd3NBcmVFeGVyY2lzZXMgPSA1XHJcbiAgICAgICAgdGhpcy5yZXBldGl0aW9uTGluZXNIYXZlQmVlbkNyZWF0ZWQgPSBmYWxzZVxyXG4gICAgICAgIHRoaXMudGFibGVMaW5lc0xlbmd0aE9mQ2FsZW5kYXJDcmVhdGlvbkxpbmVzID0gMVxyXG4gICAgICAgIHRoaXMubm9ybWFsRGFpbHlOdW1iZXJPZlN1YmplY3RzID0gM1xyXG4gICAgICAgIHRoaXMubnVtYmVyT2ZSZXBldGl0aW9ucyA9IDVcclxuICAgICAgICB0aGlzLmNyZWF0ZWRMaW5lcyA9IDBcclxuICAgICAgICB0aGlzLmN1cnJlbnRSb3dUb1JlcGVhdFxyXG4gICAgICAgIHRoaXMuaXNRdW90YUVycm9yID0gZmFsc2VcclxuICAgICAgICB0aGlzLmlzV2FybmluZyA9IGZhbHNlXHJcbiAgICAgICAgdGhpcy5tZXNzYWdlRm9yUXVvdGFFcnJvck9uZSA9IFwiRXJyZXVyIGR1IHF1b3RhIDMgbWF0acOocmVzL2ouIElsIGZhdXQgYXUgbW9pbnMgcXVlIGwndW5lIGQnZW50cmUgZWxsZXMgc29pZW50IHVuIGV4ZXJjaWNlLlwiXHJcbiAgICAgICAgdGhpcy5tZXNzYWdlRm9yUXVvdGFFcnJvclR3byA9IFwiRXJyZXVyIGR1IHF1b3RhIDMgbWF0acOocmVzL2ouIElsIGZhdXQgYXUgbW9pbnMgcXVlIGRldXggZCdlbnRyZSBlbGxlcyBzb2llbnQgdW4gZXhlcmNpY2UuXCJcclxuICAgICAgICB0aGlzLmN1cnJlbnRRdW90YUVycm9yTWVzc2FnZVRvU2hvd1xyXG4gICAgICAgIHRoaXMucmVwZXRpdGlvbiA9IG5ldyBSZXBldGl0aW9uKClcclxuICAgICAgICB0aGlzLmRhdGUgPSBuZXcgUmVwZXRpdGlvbkRhdGUoKVxyXG4gICAgfVxyXG5cclxuICAgIGhhbmRsZUFjdGlvbnNJbk1vZGFsRm9ybSgpXHJcbiAgICB7XHJcbiAgICAgICAgc3VwZXIuaGFuZGxlQWN0aW9uc0luTW9kYWxGb3JtKClcclxuICAgICAgICB0aGlzLnRvb2xzRm9yQ2FsZW5kYXJHZW5lcmF0aW9uID0gbmV3IGNhbGVuZGFyR2VuZXJhdGlvblRvb2xzKClcclxuICAgICAgICB0aGlzLmhhbmRsZUFkZExpbmVCdXR0b25DbGljaygpXHJcbiAgICAgICAgdGhpcy5oYW5kbGVDYWxlbmRhckdlbmVyYXRpb24oKVxyXG4gICAgfVxyXG5cclxuICAgIGhhbmRsZUFkZExpbmVCdXR0b25DbGljaygpXHJcbiAgICB7XHJcbiAgICAgICAgbGV0IGFkZExpbmVCdXR0b24gPSB0aGlzLm1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5hZGQtbGluZScpXHJcbiAgICAgICAgYWRkTGluZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuYXBwZW5kTmV3TGluZVRvQ2FsZW5kYXJDcmVhdGlvblRhYmxlLmJpbmQodGhpcykpICBcclxuICAgIH1cclxuXHJcbiAgICBhcHBlbmROZXdMaW5lVG9DYWxlbmRhckNyZWF0aW9uVGFibGUoZSl7XHJcbiAgICAgICAgdGhpcy5jcmVhdGVMaW5lKClcclxuICAgICAgICB0aGlzLmhhbmRsZVJlbW92ZUxpbmVCdXR0b25DbGljaygpXHJcbiAgICAgICAgdGhpcy5yZW1vdmVSb3dBY3Rpb25NZW51SWZFeGlzdHMoZSlcclxuICAgICAgICB0aGlzLmhhbmRsZUNhbGVuZGFyR2VuZXJhdGlvbigpXHJcbiAgICAgICAgdGhpcy5oYW5kbGVBZGRMaW5lQnV0dG9uQ2xpY2soKVxyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZUxpbmUgKCl7XHJcbiAgICAgICAgdGhpcy50YWJsZUxpbmVzTGVuZ3RoT2ZDYWxlbmRhckNyZWF0aW9uTGluZXMrK1xyXG4gICAgICAgIHRoaXMuY3VycmVudENyZWF0ZWRMaW5lID0gdGhpcy5jcmVhdGVFbGVtZW50KCd0cicsICdzdWJqZWN0LWxpbmUnKVxyXG4gICAgICAgIGxldCByZW1vdmVMaW5lQnV0dG9uID0gdGhpcy5tb2RhbC5xdWVyeVNlbGVjdG9yKCcucmVtb3ZlLWxpbmUnKVxyXG4gICAgICAgIGxldCBhZGRMaW5lQnV0dG9uID0gdGhpcy5tb2RhbC5xdWVyeVNlbGVjdG9yKCcuYWRkLWxpbmUnKVxyXG4gICAgICAgIGxldCBzdWJqZWN0TGluZVxyXG4gICAgICAgIGxldCBnZW5lcmF0ZUNhbGVuZGFyQnV0dG9uIFxyXG4gICAgICAgIGlmKGFkZExpbmVCdXR0b24pe1xyXG4gICAgICAgICAgICB0aGlzLmFkZExpbmVCdXR0b25Db250YWluZXIgPSBhZGRMaW5lQnV0dG9uLnBhcmVudEVsZW1lbnQgXHJcbiAgICAgICAgICAgIHN1YmplY3RMaW5lID0gdGhpcy5hZGRMaW5lQnV0dG9uQ29udGFpbmVyLnBhcmVudEVsZW1lbnRcclxuICAgICAgICAgICAgZ2VuZXJhdGVDYWxlbmRhckJ1dHRvbiA9IHN1YmplY3RMaW5lLnF1ZXJ5U2VsZWN0b3IoJy5nZW5lcmF0ZS1jYWxlbmRhcicpXHJcbiAgICAgICAgICAgIHRoaXMuZ2VuZXJhdGVDYWxlbmRhckJ1dHRvbkNvbnRhaW5lciA9IGdlbmVyYXRlQ2FsZW5kYXJCdXR0b24ucGFyZW50RWxlbWVudFxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB0aGlzLmNhbGVuZGFyQ3JlYXRpb25UYm9keSA9IHRoaXMubW9kYWwucXVlcnlTZWxlY3RvcignLmNhbGVuZGFyLWNyZWF0aW9uLXRib2R5JylcclxuICAgICAgICBpZihyZW1vdmVMaW5lQnV0dG9uICE9PSBudWxsKXtcclxuICAgICAgICAgICAgcmVtb3ZlTGluZUJ1dHRvbi5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQocmVtb3ZlTGluZUJ1dHRvbi5wYXJlbnRFbGVtZW50KSBcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5jYWxlbmRhckNyZWF0aW9uVGJvZHkuYXBwZW5kQ2hpbGQodGhpcy5jdXJyZW50Q3JlYXRlZExpbmUpXHJcbiAgICAgICAgbGV0IGN1cnJlbnRDcmVhdGVkTGluZUlubmVySFRNTCA9IGBcclxuICAgICAgICA8dGQ+PGlucHV0IHR5cGU9J3RleHQnIG5hbWU9J3N1YmplY3QtJHt0aGlzLnRhYmxlTGluZXNMZW5ndGhPZkNhbGVuZGFyQ3JlYXRpb25MaW5lc30nIGlkPSdzdWJqZWN0LWlucHV0Jz48L3RkPlxyXG4gICAgICAgIDx0ZD48aW5wdXQgdHlwZT0ndGV4dCcgbmFtZT0nY2hhcHRlci0ke3RoaXMudGFibGVMaW5lc0xlbmd0aE9mQ2FsZW5kYXJDcmVhdGlvbkxpbmVzfScgaWQ9J2NoYXB0ZXItaW5wdXQnPjwvdGQ+XHJcbiAgICAgICAgPHRkPjxpbnB1dCB0eXBlPSdkYXRlJyBuYW1lPSdkYXRlLSR7dGhpcy50YWJsZUxpbmVzTGVuZ3RoT2ZDYWxlbmRhckNyZWF0aW9uTGluZXN9JyBpZD0nZGF0ZS1pbnB1dCc+PC90ZD5cclxuICAgICAgICA8dGQ+PGlucHV0IHR5cGU9J3RpbWUnIG5hbWU9J2hvdXItJHt0aGlzLnRhYmxlTGluZXNMZW5ndGhPZkNhbGVuZGFyQ3JlYXRpb25MaW5lc30nIGlkPSdob3VyLWlucHV0Jz48L3RkPlxyXG4gICAgICAgIGBcclxuICAgICAgICBpZighdGhpcy5yZXBldGl0aW9uTGluZXNIYXZlQmVlbkNyZWF0ZWQpIHtcclxuICAgICAgICAgICAgY3VycmVudENyZWF0ZWRMaW5lSW5uZXJIVE1MICs9IGBcclxuICAgICAgICAgICAgPHRkIGNsYXNzPSdyb3dfYWN0aW9uX2J1dHRvbiBhZGRfbGluZV9idXR0b24nPjxpIGNsYXNzPSdmYXMgZmEtcGx1cyBhZGQtbGluZSc+PC9pPjwvdGQ+XHJcbiAgICAgICAgICAgIDx0ZCBjbGFzcz0ncm93X2FjdGlvbl9idXR0b24gZ2VuZXJhdGVfY2FsZW5kYXJfYnV0dG9uJz48aSBjbGFzcz0nZmFzIGZhLWNoZWNrIGdlbmVyYXRlLWNhbGVuZGFyJz48L2k+PC90ZD5cclxuICAgICAgICAgICAgPHRkIGNsYXNzPSdyb3dfYWN0aW9uX2J1dHRvbiByZW1vdmVfbGluZV9idXR0b24nPjxpIGNsYXNzPSdmYXMgZmEtd2luZG93LWNsb3NlIHJlbW92ZS1saW5lJz48L2k+PC90ZD5cclxuICAgICAgICAgICAgYFxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB0aGlzLmN1cnJlbnRDcmVhdGVkTGluZS5pbm5lckhUTUwgPSBjdXJyZW50Q3JlYXRlZExpbmVJbm5lckhUTUxcclxuICAgICAgICBpZih3aW5kb3cuaW5uZXJXaWR0aCA8PSA4MDApIHtcclxuICAgICAgICAgICAgdGhpcy5hcHBlbmRSb3dBY3Rpb25CdXR0b25zSW50b0FNZW51KClcclxuICAgICAgICB9ZWxzZSB7XHJcbiAgICAgICAgICAgIGlmKCFpc1VuZGVmaW5lZChzdWJqZWN0TGluZSkpe1xyXG4gICAgICAgICAgICAgICAgc3ViamVjdExpbmUucmVtb3ZlQ2hpbGQodGhpcy5hZGRMaW5lQnV0dG9uQ29udGFpbmVyKVxyXG4gICAgICAgICAgICAgICAgc3ViamVjdExpbmUucmVtb3ZlQ2hpbGQodGhpcy5nZW5lcmF0ZUNhbGVuZGFyQnV0dG9uQ29udGFpbmVyKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZ3Jvd0Zvcm1IZWlnaHQoKVxyXG4gICAgICAgIHRoaXMuZ3Jvd01vZGFsSGVpZ2h0KClcclxuICAgICAgICB0aGlzLmdyb3dCb2R5SGVpZ2h0SWZNb2RhbENvbGxhcHNlKClcclxuICAgIH1cclxuXHJcbiAgICBcclxuICAgIGhhbmRsZVJlbW92ZUxpbmVCdXR0b25DbGljaygpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVMaW5lQnV0dG9uID0gdGhpcy5tb2RhbC5xdWVyeVNlbGVjdG9yKCcucmVtb3ZlLWxpbmUnKSAgICAgIFxyXG4gICAgICAgIGlmKHRoaXMucmVtb3ZlTGluZUJ1dHRvbiAhPT0gbnVsbCl7XHJcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlQ2xpY2tPblJlbW92ZUxpbmVCdXR0b24oKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBoYW5kbGVDbGlja09uUmVtb3ZlTGluZUJ1dHRvbigpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVMaW5lQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpPT57XHJcbiAgICAgICAgICAgIHRoaXMudGFibGVMaW5lc0xlbmd0aE9mQ2FsZW5kYXJDcmVhdGlvbkxpbmVzLS1cclxuICAgICAgICAgICAgdGhpcy5yZW1vdmVMaW5lQnV0dG9uQ29udGFpbmVyID0gdGhpcy5yZW1vdmVMaW5lQnV0dG9uLnBhcmVudE5vZGVcclxuICAgICAgICAgICAgbGV0IHJlbW92ZUxpbmVCdXR0b25Db250YWluZXJQYXJlbnQgPSB0aGlzLnJlbW92ZUxpbmVCdXR0b25Db250YWluZXIucGFyZW50Tm9kZVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYoZWxlbWVudEhhc0NsYXNzTmFtZShyZW1vdmVMaW5lQnV0dG9uQ29udGFpbmVyUGFyZW50LCAnYWN0aW9uX21lbnUnKSkge1xyXG4gICAgICAgICAgICAgICAgcmVtb3ZlRWxlbWVudEZyb21ET00ocmVtb3ZlTGluZUJ1dHRvbkNvbnRhaW5lclBhcmVudC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nKVxyXG4gICAgICAgICAgICAgICAgcmVtb3ZlRWxlbWVudEZyb21ET00ocmVtb3ZlTGluZUJ1dHRvbkNvbnRhaW5lclBhcmVudC5wYXJlbnRFbGVtZW50KVxyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVSb3dBY3Rpb25NZW51KHJlbW92ZUxpbmVCdXR0b25Db250YWluZXJQYXJlbnQpXHJcbiAgICAgICAgICAgICAgICB0aGlzLmFwcGVuZFRvTGFzdFJvd0FjdGlvbkJ1dHRvbnMoKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5hcHBlbmRSb3dBY3Rpb25CdXR0b25zSW50b0FNZW51KClcclxuICAgICAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmVtb3ZlTGluZUJ1dHRvbkNvbnRhaW5lclBhcmVudC5jbGFzc0xpc3QuYWRkKCdpbnZpc2libGUtc3ViamVjdC1saW5lJylcclxuICAgICAgICAgICAgICAgIHJlbW92ZUxpbmVCdXR0b25Db250YWluZXJQYXJlbnQuYWRkRXZlbnRMaXN0ZW5lcignYW5pbWF0aW9uZW5kJywgKCk9PntcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbGVuZGFyQ3JlYXRpb25UYm9keS5yZW1vdmVDaGlsZChyZW1vdmVMaW5lQnV0dG9uQ29udGFpbmVyUGFyZW50KVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwZW5kVG9MYXN0Um93QWN0aW9uQnV0dG9ucygpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgYXBwZW5kVG9MYXN0Um93QWN0aW9uQnV0dG9ucygpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5jYWxlbmRhckNyZWF0aW9uVGJvZHkubGFzdEVsZW1lbnRDaGlsZC5hcHBlbmRDaGlsZCh0aGlzLmFkZExpbmVCdXR0b25Db250YWluZXIpXHJcbiAgICAgICAgdGhpcy5jYWxlbmRhckNyZWF0aW9uVGJvZHkubGFzdEVsZW1lbnRDaGlsZC5hcHBlbmRDaGlsZCh0aGlzLmdlbmVyYXRlQ2FsZW5kYXJCdXR0b25Db250YWluZXIpXHJcbiAgICAgICAgaWYodGhpcy5jYWxlbmRhckNyZWF0aW9uVGJvZHkuZmlyc3RFbGVtZW50Q2hpbGQgIT09IHRoaXMuY2FsZW5kYXJDcmVhdGlvblRib2R5Lmxhc3RFbGVtZW50Q2hpbGQpe1xyXG4gICAgICAgICAgICB0aGlzLmNhbGVuZGFyQ3JlYXRpb25UYm9keS5sYXN0RWxlbWVudENoaWxkLmFwcGVuZENoaWxkKHRoaXMucmVtb3ZlTGluZUJ1dHRvbkNvbnRhaW5lcilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucmVkdWNlRm9ybUhlaWdodFVudGlsTm9ybWFsKClcclxuICAgICAgICB0aGlzLnJlZHVjZU1vZGFsSGVpZ2h0VW50aWxOb3JtYWwoKVxyXG4gICAgICAgIHRoaXMucmVkdWNlQm9keUhlaWd0aFVudGlsTm9ybWFsKClcclxuICAgIH1cclxuXHJcbiAgICBncm93Rm9ybUhlaWdodCgpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5ncm93RWxlbWVudFNpemUodGhpcy5tb2RhbEZvcm0sIHtcclxuICAgICAgICAgICAgYXR0cmlidXRlOiAnaGVpZ2h0JyxcclxuICAgICAgICAgICAgdmFsdWU6IHRoaXMubW9kYWxGb3JtLm9mZnNldEhlaWdodCArIHRoaXMuY3VycmVudENyZWF0ZWRMaW5lLm9mZnNldEhlaWdodFxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZ3Jvd01vZGFsSGVpZ2h0KClcclxuICAgIHtcclxuICAgICAgICB0aGlzLmdyb3dFbGVtZW50U2l6ZSh0aGlzLm1vZGFsLCB7XHJcbiAgICAgICAgICAgIGF0dHJpYnV0ZTogJ2hlaWdodCcsXHJcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLm1vZGFsLm9mZnNldEhlaWdodCArIHRoaXMuY3VycmVudENyZWF0ZWRMaW5lLm9mZnNldEhlaWdodFxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBcclxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsZW1lbnQgXHJcbiAgICAgKiBAcGFyYW0ge3thdHRyaWJ1dGU6IHN0cmluZywgdmFsdWU6IG51bWJlcn19IG9wdGlvbnMgXHJcbiAgICAgKi9cclxuICAgIGdyb3dFbGVtZW50U2l6ZShlbGVtZW50LCBvcHRpb25zKVxyXG4gICAge1xyXG4gICAgICAgIGlmKG9wdGlvbnMuYXR0cmlidXRlID09PSAnd2lkdGgnKXtcclxuICAgICAgICAgICAgZWxlbWVudC5zdHlsZS53aWR0aCA9IG9wdGlvbnMudmFsdWUgKyAncHgnXHJcbiAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgICAgICBlbGVtZW50LnN0eWxlLmhlaWdodCA9IG9wdGlvbnMudmFsdWUgKyAncHgnXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBncm93Qm9keUhlaWdodElmTW9kYWxDb2xsYXBzZSgpXHJcbiAgICB7XHJcbiAgICAgICAgaWYodGhpcy5tb2RhbC5vZmZzZXRIZWlnaHQgPj0gNDcwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ3Jvd0VsZW1lbnRTaXplKGRvY3VtZW50LmJvZHksIHtcclxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZTogJ2hlaWdodCcsXHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogZG9jdW1lbnQuYm9keS5vZmZzZXRIZWlnaHQgKyB0aGlzLmN1cnJlbnRDcmVhdGVkTGluZS5vZmZzZXRIZWlnaHRcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVkdWNlRm9ybUhlaWdodFVudGlsTm9ybWFsKCkge1xyXG4gICAgICAgIGxldCBtb2RhbEZvcm1IZWlnaHQgPSB0aGlzLm1vZGFsRm9ybS5vZmZzZXRIZWlnaHRcclxuICAgICAgICBpZihtb2RhbEZvcm1IZWlnaHQgPiB0aGlzLm9yaWdpbmFsTW9kYWxGb3JtSGVpZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMubW9kYWxGb3JtLnN0eWxlLmhlaWdodCA9IG1vZGFsRm9ybUhlaWdodCAtIHRoaXMubW9kYWwucXVlcnlTZWxlY3RvcigndHInKS5vZmZzZXRIZWlnaHQgKyAncHgnXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlZHVjZU1vZGFsSGVpZ2h0VW50aWxOb3JtYWwoKVxyXG4gICAge1xyXG4gICAgICAgIGlmKHRoaXMubW9kYWwub2Zmc2V0SGVpZ2h0ID4gdGhpcy5vcmlnaW5hbE1vZGFsSGVpZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMubW9kYWwuc3R5bGUuaGVpZ2h0ID0gdGhpcy5tb2RhbC5vZmZzZXRIZWlnaHQgLSB0aGlzLm1vZGFsLnF1ZXJ5U2VsZWN0b3IoJ3RyJykub2Zmc2V0SGVpZ2h0ICsgJ3B4J1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZWR1Y2VCb2R5SGVpZ3RoVW50aWxOb3JtYWwoKVxyXG4gICAge1xyXG4gICAgICAgIGlmKGRvY3VtZW50LmJvZHkub2Zmc2V0SGVpZ2h0ID4gdGhpcy5vcmlnaW5hbEJvZHlIZWlnaHQpIHtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5oZWlnaHQgPSBkb2N1bWVudC5ib2R5Lm9mZnNldEhlaWdodCAtIHRoaXMubW9kYWwucXVlcnlTZWxlY3RvcigndHInKS5vZmZzZXRIZWlnaHQgKyAncHgnXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGhhbmRsZUNhbGVuZGFyR2VuZXJhdGlvbigpXHJcbiAgICB7XHJcbiAgICAgICAgbGV0IGdlbmVyYXRlQ2FsZW5kYXJCdXR0b24gPSB0aGlzLm1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5nZW5lcmF0ZS1jYWxlbmRhcicpXHJcbiAgICAgICAgZ2VuZXJhdGVDYWxlbmRhckJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmdlbmVyYXRlQ2FsZW5kYXIuYmluZCh0aGlzKSlcclxuICAgIH1cclxuXHJcbiAgICBnZW5lcmF0ZUNhbGVuZGFyKGUpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy50b29sc0ZvckNhbGVuZGFyR2VuZXJhdGlvbi5maWxsSW5wdXRzV2l0aFNhbWVEYXRlKClcclxuICAgICAgICB0aGlzLnRvb2xzRm9yQ2FsZW5kYXJHZW5lcmF0aW9uLmZldGNoTGluZXNUb1JlcGVhdCgpXHJcbiAgICAgICAgdGhpcy5nZW5lcmF0ZUxpbmVzT2ZSZXBldGl0aW9ucygpXHJcbiAgICAgICAgdGhpcy5yZW1vdmVSb3dBY3Rpb25NZW51SWZFeGlzdHMoZSlcclxuICAgICAgICB0aGlzLnRvb2xzRm9yQ2FsZW5kYXJHZW5lcmF0aW9uLmZldGNoUm93c1dpdGhTYW1lRGF0ZSgpXHJcbiAgICAgICAgXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgdGhpcy50b29sc0ZvckNhbGVuZGFyR2VuZXJhdGlvbi5zcGFjZUV2ZXJ5UmV2aXNpb25zU3BhY2VkVW5kZXIySCgpXHJcbiAgICAgICAgfWNhdGNoKGVycm9yKXtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcilcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2VuZXJhdGVMaW5lc09mUmVwZXRpdGlvbnMoKVxyXG4gICAge1xyXG4gICAgICAgIGxvb3BPdmVyT2JqZWN0KHRoaXMudG9vbHNGb3JDYWxlbmRhckdlbmVyYXRpb24uaW5wdXRzV2l0aFNhbWVEYXRlLCAoZGF0ZSwgaW5wdXRzKT0+e1xyXG4gICAgICAgICAgICB0aGlzLm51bWJlck9mU3ViamVjdHNJc05vcm1hbChpbnB1dHMsIGRhdGUpXHJcbiAgICAgICAgICAgIHRoaXMubnVtYmVyT2ZTdWJqZWN0c01vcmVUaGFuTm9ybWFsKGlucHV0cywgZGF0ZSlcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBudW1iZXJPZlN1YmplY3RzSXNOb3JtYWwoaW5wdXRzLCBkYXRlKVxyXG4gICAge1xyXG4gICAgICAgIGlmKGlucHV0cy5sZW5ndGggPCB0aGlzLmF0TGVhc3RPbmVSb3dJc0V4ZXJjaXNlIFxyXG4gICAgICAgICAgICAmJiB0aGlzLnRvb2xzRm9yQ2FsZW5kYXJHZW5lcmF0aW9uXHJcbiAgICAgICAgICAgICAgICAubGluZXNUb1JlcGVhdFtkYXRlXSAhPT0gdW5kZWZpbmVkXHJcbiAgICAgICAgKXtcclxuICAgICAgICAgICAgdGhpcy50b29sc0ZvckNhbGVuZGFyR2VuZXJhdGlvbi5saW5lc1RvUmVwZWF0W2RhdGVdLmZvckVhY2gocm93ID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJvd1RvUmVwZWF0ID0gcm93XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdlbmVyYXRlUmVwZXRpdGlvbnNDYWxlbmRhcihyb3cpICAgIFxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBudW1iZXJPZlN1YmplY3RzTW9yZVRoYW5Ob3JtYWwoaW5wdXRzLCBkYXRlKVxyXG4gICAge1xyXG4gICAgICAgIHN3aXRjaChpbnB1dHMubGVuZ3RoKXtcclxuICAgICAgICAgICAgY2FzZSB0aGlzLmF0TGVhc3RPbmVSb3dJc0V4ZXJjaXNlOiBcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2VuZXJhdGVSZXBldGl0aW9uc09yU2hvd1dhcm5pbmdPbmUoZGF0ZSlcclxuICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgIGNhc2UgdGhpcy5hdExlYXN0VHdvUm93c0FyZUV4ZXJjaXNlczpcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2VuZXJhdGVSZXBldGl0aW9uc09yU2hvd1dhcm5pbmdUd28oZGF0ZSlcclxuICAgICAgICAgICAgICAgIGJyZWFrICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBnZW5lcmF0ZVJlcGV0aXRpb25zT3JTaG93V2FybmluZ09uZShkYXRlKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuY3VycmVudFF1b3RhRXJyb3JNZXNzYWdlVG9TaG93ID0gdGhpcy5tZXNzYWdlRm9yUXVvdGFFcnJvck9uZVxyXG4gICAgICAgIHRoaXMuZ2VuZXJhdGVSZXBldGl0aW9uc09yU2hvd1dhcm5pbmcoZGF0ZSlcclxuICAgIH1cclxuXHJcbiAgICBnZW5lcmF0ZVJlcGV0aXRpb25zT3JTaG93V2FybmluZ1R3byhkYXRlKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuY3VycmVudFF1b3RhRXJyb3JNZXNzYWdlVG9TaG93ID0gdGhpcy5tZXNzYWdlRm9yUXVvdGFFcnJvclR3b1xyXG4gICAgICAgIHRoaXMuZ2VuZXJhdGVSZXBldGl0aW9uc09yU2hvd1dhcm5pbmcoZGF0ZSlcclxuICAgIH1cclxuXHJcbiAgICBnZW5lcmF0ZVJlcGV0aXRpb25zT3JTaG93V2FybmluZyhkYXRlKVxyXG4gICAge1xyXG4gICAgICAgIGlmKHRoaXMudG9vbHNGb3JDYWxlbmRhckdlbmVyYXRpb24ubnVtYmVyT2ZMaW5lc09mRXhlcmNpc2VQZXJEYXRlW2RhdGVdID49IDEpe1xyXG4gICAgICAgICAgICBpZighdGhpcy5pc1F1b3RhRXJyb3Ipe1xyXG4gICAgICAgICAgICAgICAgZm9yZWFjaEFycmF5RWxlbWVudHModGhpcy50b29sc0ZvckNhbGVuZGFyR2VuZXJhdGlvbi5saW5lc1RvUmVwZWF0W2RhdGVdLCAobGluZSk9PntcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRSb3dUb1JlcGVhdCA9IGxpbmVcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdlbmVyYXRlUmVwZXRpdGlvbnNDYWxlbmRhcihsaW5lKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aGlzLnNob3dXYXJuaW5nKGRhdGUpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNob3dXYXJuaW5nKGRhdGUpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5pc1F1b3RhRXJyb3IgPSB0cnVlXHJcbiAgICAgICAgdGhpcy5mb2N1c0NoYXB0ZXJJbnB1dE9uKHRoaXMudG9vbHNGb3JDYWxlbmRhckdlbmVyYXRpb24ubGluZXNUb1JlcGVhdFtkYXRlXSlcclxuICAgICAgICB0aGlzLmNyZWF0ZVdhcm5pbmcodGhpcy5jdXJyZW50UXVvdGFFcnJvck1lc3NhZ2VUb1Nob3cpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogXHJcbiAgICAgKiBAcGFyYW0ge0hUTUxUYWJsZVJvd0VsZW1lbnRbXX0gbGluZXNUb1JlcGVhdE9mQURhdGUgXHJcbiAgICAgKi9cclxuICAgIGZvY3VzQ2hhcHRlcklucHV0T24obGluZXNUb1JlcGVhdE9mQURhdGUpe1xyXG4gICAgICAgIGZvcmVhY2hBcnJheUVsZW1lbnRzKGxpbmVzVG9SZXBlYXRPZkFEYXRlLCAobGluZSk9PntcclxuICAgICAgICAgICAgdGhpcy5hbGVydEZvY3VzT25FbGVtZW50KGxpbmUucXVlcnlTZWxlY3RvcignI2NoYXB0ZXItaW5wdXQnKSlcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogXHJcbiAgICAgKiBAcGFyYW0ge0hUTUxUYWJsZVJvd0VsZW1lbnR9IHJvdyBcclxuICAgICAqL1xyXG4gICAgZ2VuZXJhdGVSZXBldGl0aW9uc0NhbGVuZGFyKHJvdyl7XHJcbiAgICAgICAgbGV0IHJvd0lucHV0cyA9IHJvdy5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCcpXHJcbiAgICAgICAgbGV0IGVtcHR5SW5wdXRFeGlzdHMgPSBmYWxzZVxyXG5cclxuICAgICAgICByb3dJbnB1dHMuZm9yRWFjaChpbnB1dCA9PiB7XHJcbiAgICAgICAgICAgIGlmKGlucHV0LnZhbHVlID09PSAnJyl7XHJcbiAgICAgICAgICAgICAgICBlbXB0eUlucHV0RXhpc3RzID0gdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICBcclxuICAgICAgICBpZighZW1wdHlJbnB1dEV4aXN0cyl7XHJcbiAgICAgICAgICAgIHRoaXMucmVwZXRpdGlvbkxpbmVzSGF2ZUJlZW5DcmVhdGVkID0gdHJ1ZVxyXG4gICAgICAgICAgICB0aGlzLmdlbmVyYXRlTGluZXMocm93KVxyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBpZihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud2FybmluZycpID09PSBudWxsKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNXYXJuaW5nID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVXYXJuaW5nKFwiSW1wb3NzaWJsZSBkZSBnw6luw6lyZXIgbGVzIHLDqXDDqXRpdGlvbnMgc2kgbGVzIGNoYW1wcyBzb250IHZpZGVzLlwiKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFxyXG4gICAgICogQHBhcmFtIHtIVE1MVGFibGVSb3dFbGVtZW50fSByb3cgXHJcbiAgICAgKi9cclxuICAgIGdlbmVyYXRlTGluZXMocm93KSB7XHJcbiAgICAgICAgZm9yKGxldCBpID0gMTsgaSA8PSB0aGlzLm51bWJlck9mUmVwZXRpdGlvbnM7IGkrKyl7XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlTGluZSgpXHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlZExpbmVzID0gaVxyXG4gICAgICAgICAgICB0aGlzLmdlbmVyYXRlSW5wdXRzVmFsdWUoKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFxyXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZWxlbWVudCBJTCBGQVVUIFJFR0xFUiBDRUNJIENBUiBDRVQgRUxFTUVOVCBSRVNURSBMJ0VMRU1FTlQgSU5JVElBTFxyXG4gICAgICovXHJcbiAgICBnZW5lcmF0ZUlucHV0c1ZhbHVlKCl7XHJcbiAgICAgICAgbGV0IHRib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigndGJvZHknKVxyXG4gICAgICAgIGxldCB0Ym9keUxhc3RDaGlsZCA9IHRib2R5Lmxhc3RFbGVtZW50Q2hpbGRcclxuICAgICAgICBsZXQgc3ViamVjdElucHV0ID0gdGJvZHlMYXN0Q2hpbGQucXVlcnlTZWxlY3RvcignI3N1YmplY3QtaW5wdXQnKVxyXG4gICAgICAgIGxldCBjaGFwdGVySW5wdXQgPSB0Ym9keUxhc3RDaGlsZC5xdWVyeVNlbGVjdG9yKCcjY2hhcHRlci1pbnB1dCcpXHJcbiAgICAgICAgbGV0IGRhdGVJbnB1dCA9IHRib2R5TGFzdENoaWxkLnF1ZXJ5U2VsZWN0b3IoJyNkYXRlLWlucHV0JylcclxuICAgICAgICBsZXQgaG91cklucHV0ID0gdGJvZHlMYXN0Q2hpbGQucXVlcnlTZWxlY3RvcignI2hvdXItaW5wdXQnKVxyXG4gICAgXHJcbiAgICAgICAgc3ViamVjdElucHV0LnZhbHVlID0gdGhpcy5jdXJyZW50Um93VG9SZXBlYXQ/LnF1ZXJ5U2VsZWN0b3IoJyNzdWJqZWN0LWlucHV0JykudmFsdWVcclxuICAgICAgICBjaGFwdGVySW5wdXQudmFsdWUgPSB0aGlzLmN1cnJlbnRSb3dUb1JlcGVhdD8ucXVlcnlTZWxlY3RvcignI2NoYXB0ZXItaW5wdXQnKS52YWx1ZVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEB0eXBlIHtbc3RyaW5nLCBzdHJpbmddfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGxldCBzcGxpdHRlZEhvdXIgPSB0aGlzLmN1cnJlbnRSb3dUb1JlcGVhdD8ucXVlcnlTZWxlY3RvcignI2hvdXItaW5wdXQnKS52YWx1ZS5zcGxpdCgnOicpXHJcbiAgICAgICAgbGV0IHNwbGl0dGVkRGF0ZSA9IHRoaXMuY3VycmVudFJvd1RvUmVwZWF0Py5xdWVyeVNlbGVjdG9yKCcjZGF0ZS1pbnB1dCcpLnZhbHVlLnNwbGl0KCctJylcclxuICAgICAgICBcclxuICAgICAgICBsZXQgeWVhciA9IHNwbGl0dGVkRGF0ZVswXVxyXG4gICAgICAgIGxldCBtb250aCA9IHNwbGl0dGVkRGF0ZVsxXVxyXG4gICAgICAgIGxldCBkYXkgPSBzcGxpdHRlZERhdGVbMl1cclxuXHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgaG91cnNGb3JOZXh0UmVwZXRpdGlvbnMgPSB0aGlzLnJlcGV0aXRpb24uaG91cnNGb3JOZXh0UmVwZXRpdGlvbnNbdGhpcy5jcmVhdGVkTGluZXNdXHJcbiAgICAgICAgbGV0IGhvdXJCZXR3ZWVuQ3VycmVudEFuZE5leHRSZXBldGl0aW9uID0gaG91cnNGb3JOZXh0UmVwZXRpdGlvbnNbMF1cclxuICAgICAgICBcclxuICAgICAgICBsZXQgaG91ckZvck5leFJlcGV0aXRpb24gPSBwYXJzZUludChzcGxpdHRlZEhvdXJbMF0sIDEwKSArIGhvdXJCZXR3ZWVuQ3VycmVudEFuZE5leHRSZXBldGl0aW9uXHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYodGhpcy5jcmVhdGVkTGluZXMgPT09IDEpe1xyXG4gICAgICAgICAgICBpZihob3VyRm9yTmV4UmVwZXRpdGlvbiA8IDIwKXtcclxuICAgICAgICAgICAgICAgIGRhdGVJbnB1dC52YWx1ZSA9IHRoaXMuY3VycmVudFJvd1RvUmVwZWF0Py5xdWVyeVNlbGVjdG9yKCcjZGF0ZS1pbnB1dCcpLnZhbHVlXHJcbiAgICAgICAgICAgICAgICBob3VySW5wdXQudmFsdWUgPSBob3VyRm9yTmV4UmVwZXRpdGlvbi50b1N0cmluZygxMCkubGVuZ3RoID09PSAxID8gXHJcbiAgICAgICAgICAgICAgICAgICAgXCIwXCIgKyBob3VyRm9yTmV4UmVwZXRpdGlvbiArICc6JyArIHNwbGl0dGVkSG91clsxXSA6XHJcbiAgICAgICAgICAgICAgICAgICAgaG91ckZvck5leFJlcGV0aXRpb24gKyAnOicgKyBzcGxpdHRlZEhvdXJbMV1cclxuICAgICAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbGV0IGludE5ld0RheVZhbHVlID0gcGFyc2VJbnQoZGF5KSArIDFcclxuICAgICAgICAgICAgICAgIGxldCBuZXdEYXlWYWx1ZSA9IGludE5ld0RheVZhbHVlLnRvU3RyaW5nKCkubGVuZ3RoID09PSAxID8gJzAnICsgaW50TmV3RGF5VmFsdWUudG9TdHJpbmcoKSA6IGludE5ld0RheVZhbHVlXHJcbiAgICAgICAgICAgICAgICBob3VyRm9yTmV4UmVwZXRpdGlvbiA9IDhcclxuICAgICAgICAgICAgICAgIGRhdGVJbnB1dC52YWx1ZSA9IHllYXIgKyAnLScgKyBtb250aCArICctJyArIG5ld0RheVZhbHVlXHJcblxyXG4gICAgICAgICAgICAgICAgaWYoZGF0ZUlucHV0LnZhbHVlID09PSAnJyl7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGludE1vbnRoID0gcGFyc2VJbnQobW9udGgpXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoaW50TW9udGggPCAxMil7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVJbnB1dC52YWx1ZSA9IHllYXIgKyAnLTAnICsgKGludE1vbnRoICsgMSkgKyAnLScgKyAnMDEnXHJcbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVJbnB1dC52YWx1ZSA9IChwYXJzZUludCh5ZWFyKSArIDEpICsgJy0nICsgJzAxJyArICctJyArICcwMSdcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBob3VySW5wdXQudmFsdWUgPSAnMCcgKyBob3VyRm9yTmV4UmVwZXRpdGlvbiArICc6JyArIHNwbGl0dGVkSG91clsxXVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH1lbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgaW50RGF5ID0gcGFyc2VJbnQoZGF5KVxyXG4gICAgICAgICAgICBsZXQgaW50TmV3RGF5VmFsdWUgPSBpbnREYXkgKyBob3Vyc0Zvck5leHRSZXBldGl0aW9uc1sxXVxyXG4gICAgICAgICAgICBsZXQgbmV3RGF5VmFsdWUgPSBpbnROZXdEYXlWYWx1ZS50b1N0cmluZygpLmxlbmd0aCA9PT0gMSA/ICcwJyArIGludE5ld0RheVZhbHVlLnRvU3RyaW5nKCkgOiBpbnROZXdEYXlWYWx1ZVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZGF0ZUlucHV0LnZhbHVlID0geWVhciArICctJyArIG1vbnRoICsgJy0nICsgbmV3RGF5VmFsdWVcclxuICAgICAgICAgICAgaWYoZGF0ZUlucHV0LnZhbHVlID09PSAnJyl7XHJcbiAgICAgICAgICAgICAgICBsZXQgaW50TW9udGggPSBwYXJzZUludChtb250aClcclxuICAgICAgICAgICAgICAgIGNvbnN0IGludERheUluTmV4dE1vbnRoID0gaW50TmV3RGF5VmFsdWUgLSB0aGlzLmRhdGUubnVtYmVyT2ZEYXlzUGVyTW9udGhbaW50TW9udGhdXHJcbiAgICAgICAgICAgICAgICBjb25zdCBkYXlJbk5leHRNb250aCA9IGludERheUluTmV4dE1vbnRoLnRvU3RyaW5nKCkubGVuZ3RoID09PSAxID8gXCIwXCIgKyBpbnREYXlJbk5leHRNb250aCA6IGludERheUluTmV4dE1vbnRoXHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmKGludE1vbnRoIDwgMTIpe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGVJbnB1dC52YWx1ZSA9IHllYXIgKyAnLTAnICsgKGludE1vbnRoICsgMSkgKyAnLScgKyBkYXlJbk5leHRNb250aFxyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZUlucHV0LnZhbHVlID0gKHBhcnNlSW50KHllYXIpICsgMSkgKyAnLScgKyAnMDEnICsgJy0nICsgJzAxJ1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGhvdXJJbnB1dC52YWx1ZSA9IHNwbGl0dGVkSG91clswXSArICc6JyArIHNwbGl0dGVkSG91clsxXVxyXG4gICAgICAgIH0gICBcclxuXHJcbiAgICAgICAgdGhpcy5jdXJyZW50Um93VG9SZXBlYXQgPSB0Ym9keUxhc3RDaGlsZFxyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZVdhcm5pbmcobWVzc2FnZSl7XHJcbiAgICBcclxuICAgICAgICBsZXQgd2FybmluZ1BhcmFncmFwaCA9IHRoaXMuY3JlYXRlRWxlbWVudCgncCcsICd3YXJuaW5nJylcclxuICAgICAgICBsZXQgaSA9IHRoaXMuY3JlYXRlRWxlbWVudCgnaScsICdmYXMgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUnKVxyXG4gICAgICAgIGxldCBzcGFuID0gdGhpcy5jcmVhdGVFbGVtZW50KCdzcGFuJywgJ3dhcm5pbmctbWVzc2FnZScpXHJcblxyXG4gICAgICAgIHdhcm5pbmdQYXJhZ3JhcGguYXBwZW5kQ2hpbGQoaSlcclxuICAgICAgICB3YXJuaW5nUGFyYWdyYXBoLmFwcGVuZENoaWxkKHNwYW4pXHJcbiAgICAgICAgc3Bhbi5pbm5lckhUTUwgPSBtZXNzYWdlXHJcblxyXG4gICAgICAgIHRoaXMubW9kYWwucXVlcnlTZWxlY3RvcignYnV0dG9uJykuYmVmb3JlKHdhcm5pbmdQYXJhZ3JhcGgpXHJcbiAgICAgICAgd2FybmluZ1BhcmFncmFwaC5vZmZzZXRXaWR0aFxyXG4gICAgICAgIHdhcm5pbmdQYXJhZ3JhcGguY2xhc3NMaXN0LmFkZCgnYWN0aXZlX3dhcm5pbmcnKVxyXG4gICAgICAgIGNvbnN0IG1hcmdpbkJvdHRvbSA9IDMwXHJcbiAgICAgICAgdGhpcy5tb2RhbC5zdHlsZS5oZWlnaHQgPSB0aGlzLm1vZGFsLm9mZnNldEhlaWdodCArIHdhcm5pbmdQYXJhZ3JhcGgub2Zmc2V0SGVpZ2h0ICsgbWFyZ2luQm90dG9tICsgJ3B4J1xyXG5cclxuICAgICAgICB0aGlzLnJlbW92ZUVsZW1lbnRBZnRlck1pbGxpc2Vjb25kcyh3YXJuaW5nUGFyYWdyYXBoLCA1MDAwLCB7XHJcbiAgICAgICAgICAgIGNsYXNzTmFtZVRvUmVtb3ZlOiAnYWN0aXZlX3dhcm5pbmcnLFxyXG4gICAgICAgICAgICBlbGVtZW50V2l0aEhlaWdodFRvRGVjcmVhc2U6IFt0aGlzLm1vZGFsLCB3YXJuaW5nUGFyYWdyYXBoLm9mZnNldEhlaWdodCArIG1hcmdpbkJvdHRvbV1cclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIHBvc3RDb250ZW50V2l0aE5vdGlmaWNhdGlvblRoZW5SZWxvYWQoKVxyXG4gICAge1xyXG4gICAgICAgIHBvc3QodGhpcy5mb3JtQWN0aW9uLCB0aGlzLmRhdGFUb1Bvc3RPYmopXHJcbiAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlUmVxdWVzdFJlc3BvbnNlKHJlc3BvbnNlKVxyXG4gICAgICAgICAgICB9KS5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiSWwgeSBhIGV1IHVuZSBlcnJldXIgOlwiICsgZXJyb3IpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgaGFuZGxlUmVxdWVzdFJlc3BvbnNlKHJlc3BvbnNlKVxyXG4gICAge1xyXG4gICAgICAgIGxldCByZXNwb25zZUpzb24gPSBKU09OLnBhcnNlKHJlc3BvbnNlKVxyXG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSByZXNwb25zZUpzb24uc3VjY2VzcyAhPT0gdW5kZWZpbmVkID8gcmVzcG9uc2VKc29uLnN1Y2Nlc3MgOiByZXNwb25zZUpzb24uZmFpbFxyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuc2hvd05vdGlmaWNhdGlvbldpdGhEYXRhSW5NaWxsaXNlY29uZHMoe1xyXG4gICAgICAgICAgICBjbGFzc05hbWU6IHRoaXMubm90aWZpY2F0aW9uQ2xhc3NOYW1lLCBcclxuICAgICAgICAgICAgY29udGVudDogbWVzc2FnZVxyXG4gICAgICAgIH0sIDIwMDApXHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5yZWxvYWRQYWdlKCkgXHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2VNb2RhbCgpXHJcbiAgICB7XHJcbiAgICAgICAgc3VwZXIuY2xvc2VNb2RhbCgpXHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5oZWlnaHQgPSB0aGlzLm9yaWdpbmFsQm9keUhlaWdodCArICdweCdcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVSb3dBY3Rpb25NZW51SWZFeGlzdHMoZSlcclxuICAgIHtcclxuICAgICAgICBsZXQgY2xpY2tlZEJ1dHRvbkdyYW5kUGFyZW50ID0gZS5jdXJyZW50VGFyZ2V0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudFxyXG4gICAgICAgIGlmKGNsaWNrZWRCdXR0b25HcmFuZFBhcmVudCBcclxuICAgICAgICAgICAgJiYgZWxlbWVudEhhc0NsYXNzTmFtZShjbGlja2VkQnV0dG9uR3JhbmRQYXJlbnQsJ2FjdGlvbl9tZW51JylcclxuICAgICAgICAgICAgJiYgIXRoaXMuaXNXYXJuaW5nICAgIFxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICB0aGlzLnJlbW92ZVJvd0FjdGlvbk1lbnUoY2xpY2tlZEJ1dHRvbkdyYW5kUGFyZW50KVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVSb3dBY3Rpb25NZW51KHJvd0FjdGlvbk1lbnUpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5oaWRlUm93QWN0aW9uTWVudShyb3dBY3Rpb25NZW51KVxyXG4gICAgICAgIGxldCByb3dBY3Rpb25NZW51QnV0dG9uID0gcm93QWN0aW9uTWVudS5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5hY3Rpb25fbWVudV9idXR0b24nKVxyXG4gICAgICAgIGlmKHJvd0FjdGlvbk1lbnVCdXR0b24pe1xyXG4gICAgICAgICAgICByZW1vdmVFbGVtZW50RnJvbURPTShyb3dBY3Rpb25NZW51QnV0dG9uKVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZW1vdmVFbGVtZW50RnJvbURPTShyb3dBY3Rpb25NZW51KVxyXG4gICAgfVxyXG5cclxuICAgIGhhbmRsZU1vZGFsUmVzcG9uc2l2ZSgpXHJcbiAgICB7XHJcbiAgICAgICAgbmV3IG1vZGFsUmVzaXplKHRoaXMpXHJcbiAgICB9XHJcblxyXG4gICAgYXBwZW5kUm93QWN0aW9uQnV0dG9uc0ludG9BTWVudSgpXHJcbiAgICB7XHJcbiAgICAgICAgaWYoXHJcbiAgICAgICAgICAgICh0aGlzLm1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5hY3Rpb25fbWVudV9idXR0b24nKSA9PT0gbnVsbCB8fCB0aGlzLmxhc3RTdWJqZWN0Um93ICE9PSBudWxsKVxyXG4gICAgICAgICAgICAmJiAhdGhpcy5yZXBldGl0aW9uTGluZXNIYXZlQmVlbkNyZWF0ZWRcclxuICAgICAgICApe1xyXG4gICAgICAgICAgICB0aGlzLnN1YmplY3RSb3dzID0gY3JlYXRlQXJyYXkodGhpcy5tb2RhbC5xdWVyeVNlbGVjdG9yQWxsKCcuc3ViamVjdC1saW5lJykpXHJcbiAgICAgICAgICAgIHRoaXMubGFzdFN1YmplY3RSb3dJbmRleCA9IHRoaXMuc3ViamVjdFJvd3MubGVuZ3RoIC0gMVxyXG4gICAgICAgICAgICB0aGlzLmxhc3RTdWJqZWN0Um93ID0gdGhpcy5zdWJqZWN0Um93c1t0aGlzLmxhc3RTdWJqZWN0Um93SW5kZXhdXHJcbiAgICAgICAgICAgIGxldCByb3dBY3Rpb25CdXR0b25zID0gY3JlYXRlQXJyYXkodGhpcy5sYXN0U3ViamVjdFJvdy5xdWVyeVNlbGVjdG9yQWxsKCcucm93X2FjdGlvbl9idXR0b24nKSlcclxuICAgICAgICAgICAgdGhpcy5hY3Rpb25zQnV0dG9uc1BlclJvd1t0aGlzLmxhc3RTdWJqZWN0Um93SW5kZXhdID0gcm93QWN0aW9uQnV0dG9uc1xyXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZU1lbnVGb3JMYXN0Um93KClcclxuICAgICAgICB9ZWxzZSBpZih0aGlzLnJlcGV0aXRpb25MaW5lc0hhdmVCZWVuQ3JlYXRlZCkge1xyXG4gICAgICAgICAgICB0aGlzLmxhc3RTdWJqZWN0Um93ID0gbnVsbFxyXG4gICAgICAgICAgICB0aGlzLnJvd0FjdGlvbk1lbnVCdXR0b24gPSBudWxsXHJcbiAgICAgICAgICAgIHRoaXMuYWN0aW9uTWVudSA9IG51bGxcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlTWVudUZvckxhc3RSb3coKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuY3JlYXRlQWN0aW9uTWVudUJ1dHRvbih0aGlzLmxhc3RTdWJqZWN0Um93KVxyXG4gICAgICAgIHRoaXMuY3JlYXRlTWVudUluUm93VGhlbkFwcGVuZENoaWxkcmVuKHRoaXMubGFzdFN1YmplY3RSb3csIHRoaXMuYWN0aW9uc0J1dHRvbnNQZXJSb3dbdGhpcy5sYXN0U3ViamVjdFJvd0luZGV4XSlcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFxyXG4gICAgICogQHBhcmFtIHtIVE1MVGFibGVSb3dFbGVtZW50fSByb3cgXHJcbiAgICAgKi9cclxuICAgIGNyZWF0ZUFjdGlvbk1lbnVCdXR0b24ocm93KVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMucm93QWN0aW9uTWVudUJ1dHRvbiA9IHJvdy5xdWVyeVNlbGVjdG9yKCcuYWN0aW9uX21lbnVfYnV0dG9uJylcclxuICAgICAgICBpZihpc1VuZGVmaW5lZCh0aGlzLnJvd0FjdGlvbk1lbnVCdXR0b24pIHx8IHRoaXMucm93QWN0aW9uTWVudUJ1dHRvbiA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLnJvd0FjdGlvbk1lbnVCdXR0b24gPSB0aGlzLmNyZWF0ZUVsZW1lbnQoJ3RkJywgJ2FjdGlvbl9tZW51X2J1dHRvbicpXHJcbiAgICAgICAgICAgIHRoaXMucm93QWN0aW9uTWVudUJ1dHRvbi5pbm5lckhUTUwgPSBgPHAgY2xhc3M9J2hvdF9kb2dfbWVudV9jaXJjbGUnPjwvcD5cclxuICAgICAgICAgICAgPHAgY2xhc3M9J2hvdF9kb2dfbWVudV9jaXJjbGUnPjwvcD5cclxuICAgICAgICAgICAgPHAgY2xhc3M9J2hvdF9kb2dfbWVudV9jaXJjbGUnPjwvcD5gXHJcbiAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZCh0aGlzLnJvd0FjdGlvbk1lbnVCdXR0b24pXHJcbiAgICAgICAgICAgIHRoaXMucm93QWN0aW9uTWVudUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMudG9nZ2xlQWN0aW9uTWVudU9mVGhlUm93LmJpbmQodGhpcywgcm93KSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBcclxuICAgICAqIEBwYXJhbSB7SFRNTFRhYmxlUm93RWxlbWVudH0gcm93IFxyXG4gICAgICovXHJcbiAgICBjcmVhdGVNZW51SW5Sb3dUaGVuQXBwZW5kQ2hpbGRyZW4ocm93LCBmdXR1ckNoaWxkcmVuKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuYWN0aW9uTWVudSA9IHRoaXMuY3JlYXRlRWxlbWVudCgnZGl2JywgJ2FjdGlvbl9tZW51JylcclxuICAgICAgICBmdXR1ckNoaWxkcmVuLmZvckVhY2goZnV0dXJDaGlsZCA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuYWN0aW9uTWVudS5hcHBlbmRDaGlsZChmdXR1ckNoaWxkKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdGhpcy5hY3Rpb25NZW51LnNldEF0dHJpYnV0ZSgnaGlkZGVuJywgJ3RydWUnKVxyXG4gICAgICAgIHJvdy5hcHBlbmRDaGlsZCh0aGlzLmFjdGlvbk1lbnUpXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBcclxuICAgICAqIEBwYXJhbSB7SFRNTFRhYmxlUm93RWxlbWVudH0gcm93IFxyXG4gICAgICovXHJcbiAgICB0b2dnbGVBY3Rpb25NZW51T2ZUaGVSb3cocm93KVxyXG4gICAge1xyXG4gICAgICAgIGxldCByb3dBY3Rpb25NZW51ID0gcm93Lmxhc3RFbGVtZW50Q2hpbGRcclxuICAgICAgICBpZihyb3dBY3Rpb25NZW51Lmhhc0F0dHJpYnV0ZSgnaGlkZGVuJykpIHtcclxuICAgICAgICAgICAgdGhpcy5zaG93Um93QWN0aW9uTWVudShyb3dBY3Rpb25NZW51KVxyXG4gICAgICAgIH1lbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5oaWRlUm93QWN0aW9uTWVudShyb3dBY3Rpb25NZW51KVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzaG93Um93QWN0aW9uTWVudShyb3dBY3Rpb25NZW51KVxyXG4gICAge1xyXG4gICAgICAgIHJvd0FjdGlvbk1lbnUucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKVxyXG4gICAgICAgIHJvd0FjdGlvbk1lbnUub2Zmc2V0V2lkdGhcclxuICAgICAgICByb3dBY3Rpb25NZW51LmNsYXNzTGlzdC5hZGQoJ3Zpc2libGVfYWN0aW9uX21lbnUnKVxyXG4gICAgICAgIGlmKHJvd0FjdGlvbk1lbnUuY2hpbGRyZW4ubGVuZ3RoID09PSAzKSB7XHJcbiAgICAgICAgICAgIHJvd0FjdGlvbk1lbnUuY2xhc3NMaXN0LmFkZCgndGhyZWVfY2hpbGRyZW4nKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBoaWRlUm93QWN0aW9uTWVudShyb3dBY3Rpb25NZW51KSBcclxuICAgIHtcclxuICAgICAgICByb3dBY3Rpb25NZW51LmNsYXNzTGlzdC5yZW1vdmUoJ3Zpc2libGVfYWN0aW9uX21lbnUnKVxyXG4gICAgICAgIGNvbnN0IGhhbmRsZVRyYW5zaXRpb25FbmQgPSAoKT0+e1xyXG4gICAgICAgICAgICByb3dBY3Rpb25NZW51LnNldEF0dHJpYnV0ZSgnaGlkZGVuJywgJ3RydWUnKVxyXG4gICAgICAgICAgICBpZihlbGVtZW50SGFzQ2xhc3NOYW1lKHJvd0FjdGlvbk1lbnUsICd0aHJlZV9jaGlsZHJlbicpKSB7XHJcbiAgICAgICAgICAgICAgICByb3dBY3Rpb25NZW51LmNsYXNzTGlzdC5yZW1vdmUoJ3RocmVlX2NoaWxkcmVuJylcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByb3dBY3Rpb25NZW51LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RyYW5zaXRpb25lbmQnLCBoYW5kbGVUcmFuc2l0aW9uRW5kKVxyXG4gICAgICAgIH1cclxuICAgICAgICByb3dBY3Rpb25NZW51LmFkZEV2ZW50TGlzdGVuZXIoJ3RyYW5zaXRpb25lbmQnLCBoYW5kbGVUcmFuc2l0aW9uRW5kKVxyXG4gICAgfVxyXG5cclxuICAgIGdldFJvd0FjdGlvbkJ1dHRvbnNPdXRPZk1lbnUoKVxyXG4gICAge1xyXG4gICAgICAgIGlmKHRoaXMuYWN0aW9uTWVudUV4aXN0cygpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXBwZW5kQWN0aW9uQnV0dG9uc0luUGFyZW50Um93KClcclxuICAgICAgICAgICAgaWYodGhpcy5hY3Rpb25NZW51ICE9PSBudWxsICYmICFpc1VuZGVmaW5lZCh0aGlzLmFjdGlvbk1lbnUpKSB7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVFbGVtZW50RnJvbURPTSh0aGlzLmFjdGlvbk1lbnUpXHJcbiAgICAgICAgICAgICAgICByZW1vdmVFbGVtZW50RnJvbURPTSh0aGlzLnJvd0FjdGlvbk1lbnVCdXR0b24pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgYWN0aW9uTWVudUV4aXN0cygpXHJcbiAgICB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubGFzdFN1YmplY3RSb3cgIT09IG51bGwgJiYgdGhpcy5yb3dBY3Rpb25NZW51QnV0dG9uICE9PSBudWxsICYmIHRoaXMuYWN0aW9uTWVudSAhPT0gbnVsbFxyXG4gICAgfVxyXG5cclxuICAgIGFwcGVuZEFjdGlvbkJ1dHRvbnNJblBhcmVudFJvdygpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5hY3Rpb25zQnV0dG9uc1BlclJvd1t0aGlzLmxhc3RTdWJqZWN0Um93SW5kZXhdLmZvckVhY2goYWN0aW9uQnV0dG9uID0+IHtcclxuICAgICAgICAgICAgdGhpcy5zdWJqZWN0Um93c1t0aGlzLmxhc3RTdWJqZWN0Um93SW5kZXhdLmFwcGVuZENoaWxkKGFjdGlvbkJ1dHRvbilcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGFsZXJ0RW1wdHlJbnB1dHMoKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMubW9kYWxJbnB1dHMuZm9yRWFjaChpbnB1dCA9PiB7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuaXNNZXNzYWdlQ29ycmVzcG9uZHNUbyhpbnB1dC5uYW1lKSl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFsZXJ0Rm9jdXNPbkVsZW1lbnQoaW5wdXQpXHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUFsZXJ0Rm9jdXNXaGVuY2xpY2soaW5wdXQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfVxyXG59Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///505\n')}}]);